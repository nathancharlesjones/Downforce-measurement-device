ARM GAS  /tmp/cctRxqh5.s 			page 1


   1              		.cpu cortex-m3
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 1
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 4
  11              		.file	"sd_io.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.text.__SD_Power_Of_Two,"ax",%progbits
  16              		.align	1
  17              		.global	__SD_Power_Of_Two
  18              		.syntax unified
  19              		.thumb
  20              		.thumb_func
  21              		.fpu softvfp
  23              	__SD_Power_Of_Two:
  24              	.LFB0:
  25              		.file 1 "Middlewares/Third_Party/ulibSD/sd_io.c"
   1:Middlewares/Third_Party/ulibSD/sd_io.c **** /*
   2:Middlewares/Third_Party/ulibSD/sd_io.c ****  *  File: sd_io.c
   3:Middlewares/Third_Party/ulibSD/sd_io.c ****  *  Author: Nelson Lombardo
   4:Middlewares/Third_Party/ulibSD/sd_io.c ****  *  Year: 2015
   5:Middlewares/Third_Party/ulibSD/sd_io.c ****  *  e-mail: nelson.lombardo@gmail.com
   6:Middlewares/Third_Party/ulibSD/sd_io.c ****  *  License at the end of file.
   7:Middlewares/Third_Party/ulibSD/sd_io.c ****  */
   8:Middlewares/Third_Party/ulibSD/sd_io.c **** 
   9:Middlewares/Third_Party/ulibSD/sd_io.c **** #include "sd_io.h"
  10:Middlewares/Third_Party/ulibSD/sd_io.c **** 
  11:Middlewares/Third_Party/ulibSD/sd_io.c **** #ifdef _M_IX86  // For use over x86
  12:Middlewares/Third_Party/ulibSD/sd_io.c **** /*****************************************************************************/
  13:Middlewares/Third_Party/ulibSD/sd_io.c **** /* Private Methods Prototypes - Direct work with PC file                     */
  14:Middlewares/Third_Party/ulibSD/sd_io.c **** /*****************************************************************************/
  15:Middlewares/Third_Party/ulibSD/sd_io.c **** 
  16:Middlewares/Third_Party/ulibSD/sd_io.c **** /**
  17:Middlewares/Third_Party/ulibSD/sd_io.c ****  * \brief Get the total numbers of sectors in SD card.
  18:Middlewares/Third_Party/ulibSD/sd_io.c ****  * \param dev Device descriptor.
  19:Middlewares/Third_Party/ulibSD/sd_io.c ****  * \return Quantity of sectors. Zero if fail.
  20:Middlewares/Third_Party/ulibSD/sd_io.c ****  */
  21:Middlewares/Third_Party/ulibSD/sd_io.c **** DWORD __SD_Sectors (SD_DEV* dev);
  22:Middlewares/Third_Party/ulibSD/sd_io.c **** 
  23:Middlewares/Third_Party/ulibSD/sd_io.c **** /*****************************************************************************/
  24:Middlewares/Third_Party/ulibSD/sd_io.c **** /* Private Methods - Direct work with PC file                                */
  25:Middlewares/Third_Party/ulibSD/sd_io.c **** /*****************************************************************************/
  26:Middlewares/Third_Party/ulibSD/sd_io.c **** 
  27:Middlewares/Third_Party/ulibSD/sd_io.c **** DWORD __SD_Sectors (SD_DEV *dev)
  28:Middlewares/Third_Party/ulibSD/sd_io.c **** {
  29:Middlewares/Third_Party/ulibSD/sd_io.c ****     if (dev->fp == NULL) return(0); // Fail
  30:Middlewares/Third_Party/ulibSD/sd_io.c ****     else {
  31:Middlewares/Third_Party/ulibSD/sd_io.c ****         fseek(dev->fp, 0L, SEEK_END);
  32:Middlewares/Third_Party/ulibSD/sd_io.c ****         return (((DWORD)(ftell(dev->fp)))/((DWORD)512)-1);
  33:Middlewares/Third_Party/ulibSD/sd_io.c ****     }
ARM GAS  /tmp/cctRxqh5.s 			page 2


  34:Middlewares/Third_Party/ulibSD/sd_io.c **** }
  35:Middlewares/Third_Party/ulibSD/sd_io.c **** #else   // For use with uControllers   
  36:Middlewares/Third_Party/ulibSD/sd_io.c **** /******************************************************************************
  37:Middlewares/Third_Party/ulibSD/sd_io.c ****  Private Methods Prototypes - Direct work with SD card
  38:Middlewares/Third_Party/ulibSD/sd_io.c **** ******************************************************************************/
  39:Middlewares/Third_Party/ulibSD/sd_io.c **** 
  40:Middlewares/Third_Party/ulibSD/sd_io.c **** /**
  41:Middlewares/Third_Party/ulibSD/sd_io.c ****     \brief Simple function to calculate power of two.
  42:Middlewares/Third_Party/ulibSD/sd_io.c ****     \param e Exponent.
  43:Middlewares/Third_Party/ulibSD/sd_io.c ****     \return Math function result.
  44:Middlewares/Third_Party/ulibSD/sd_io.c **** */
  45:Middlewares/Third_Party/ulibSD/sd_io.c **** DWORD __SD_Power_Of_Two(BYTE e);
  46:Middlewares/Third_Party/ulibSD/sd_io.c **** 
  47:Middlewares/Third_Party/ulibSD/sd_io.c **** /**
  48:Middlewares/Third_Party/ulibSD/sd_io.c ****      \brief Assert the SD card (SPI CS low).
  49:Middlewares/Third_Party/ulibSD/sd_io.c ****  */
  50:Middlewares/Third_Party/ulibSD/sd_io.c **** inline void __SD_Assert (void);
  51:Middlewares/Third_Party/ulibSD/sd_io.c **** 
  52:Middlewares/Third_Party/ulibSD/sd_io.c **** /**
  53:Middlewares/Third_Party/ulibSD/sd_io.c ****     \brief Deassert the SD (SPI CS high).
  54:Middlewares/Third_Party/ulibSD/sd_io.c ****  */
  55:Middlewares/Third_Party/ulibSD/sd_io.c **** inline void __SD_Deassert (void);
  56:Middlewares/Third_Party/ulibSD/sd_io.c **** 
  57:Middlewares/Third_Party/ulibSD/sd_io.c **** /**
  58:Middlewares/Third_Party/ulibSD/sd_io.c ****     \brief Change to max the speed transfer.
  59:Middlewares/Third_Party/ulibSD/sd_io.c ****     \param throttle
  60:Middlewares/Third_Party/ulibSD/sd_io.c ****  */
  61:Middlewares/Third_Party/ulibSD/sd_io.c **** void __SD_Speed_Transfer (BYTE throttle);
  62:Middlewares/Third_Party/ulibSD/sd_io.c **** 
  63:Middlewares/Third_Party/ulibSD/sd_io.c **** /**
  64:Middlewares/Third_Party/ulibSD/sd_io.c ****     \brief Send SPI commands.
  65:Middlewares/Third_Party/ulibSD/sd_io.c ****     \param cmd Command to send.
  66:Middlewares/Third_Party/ulibSD/sd_io.c ****     \param arg Argument to send.
  67:Middlewares/Third_Party/ulibSD/sd_io.c ****     \return R1 response.
  68:Middlewares/Third_Party/ulibSD/sd_io.c ****  */
  69:Middlewares/Third_Party/ulibSD/sd_io.c **** BYTE __SD_Send_Cmd(BYTE cmd, DWORD arg);
  70:Middlewares/Third_Party/ulibSD/sd_io.c **** 
  71:Middlewares/Third_Party/ulibSD/sd_io.c **** /**
  72:Middlewares/Third_Party/ulibSD/sd_io.c ****     \brief Write a data block on SD card.
  73:Middlewares/Third_Party/ulibSD/sd_io.c ****     \param dat Storage the data to transfer.
  74:Middlewares/Third_Party/ulibSD/sd_io.c ****     \param token Inidicates the type of transfer (single or multiple).
  75:Middlewares/Third_Party/ulibSD/sd_io.c ****  */
  76:Middlewares/Third_Party/ulibSD/sd_io.c **** SDRESULTS __SD_Write_Block(SD_DEV *dev, void *dat, BYTE token);
  77:Middlewares/Third_Party/ulibSD/sd_io.c **** 
  78:Middlewares/Third_Party/ulibSD/sd_io.c **** /**
  79:Middlewares/Third_Party/ulibSD/sd_io.c ****     \brief Get the total numbers of sectors in SD card.
  80:Middlewares/Third_Party/ulibSD/sd_io.c ****     \param dev Device descriptor.
  81:Middlewares/Third_Party/ulibSD/sd_io.c ****     \return Quantity of sectors. Zero if fail.
  82:Middlewares/Third_Party/ulibSD/sd_io.c ****  */
  83:Middlewares/Third_Party/ulibSD/sd_io.c **** DWORD __SD_Sectors (SD_DEV *dev);
  84:Middlewares/Third_Party/ulibSD/sd_io.c **** 
  85:Middlewares/Third_Party/ulibSD/sd_io.c **** /******************************************************************************
  86:Middlewares/Third_Party/ulibSD/sd_io.c ****  Private Methods - Direct work with SD card
  87:Middlewares/Third_Party/ulibSD/sd_io.c **** ******************************************************************************/
  88:Middlewares/Third_Party/ulibSD/sd_io.c **** 
  89:Middlewares/Third_Party/ulibSD/sd_io.c **** DWORD __SD_Power_Of_Two(BYTE e)
  90:Middlewares/Third_Party/ulibSD/sd_io.c **** {
ARM GAS  /tmp/cctRxqh5.s 			page 3


  26              		.loc 1 90 0
  27              		.cfi_startproc
  28              		@ args = 0, pretend = 0, frame = 0
  29              		@ frame_needed = 0, uses_anonymous_args = 0
  30              		@ link register save eliminated.
  31              	.LVL0:
  91:Middlewares/Third_Party/ulibSD/sd_io.c ****     DWORD partial = 1;
  92:Middlewares/Third_Party/ulibSD/sd_io.c ****     BYTE idx;
  93:Middlewares/Third_Party/ulibSD/sd_io.c ****     for(idx=0; idx!=e; idx++) partial *= 2;
  32              		.loc 1 93 0
  33 0000 0023     		movs	r3, #0
  91:Middlewares/Third_Party/ulibSD/sd_io.c ****     DWORD partial = 1;
  34              		.loc 1 91 0
  35 0002 0122     		movs	r2, #1
  36              		.loc 1 93 0
  37 0004 02E0     		b	.L2
  38              	.LVL1:
  39              	.L3:
  40              		.loc 1 93 0 is_stmt 0 discriminator 3
  41 0006 5200     		lsls	r2, r2, #1
  42              	.LVL2:
  43 0008 0133     		adds	r3, r3, #1
  44              	.LVL3:
  45 000a DBB2     		uxtb	r3, r3
  46              	.LVL4:
  47              	.L2:
  48              		.loc 1 93 0 discriminator 1
  49 000c 8342     		cmp	r3, r0
  50 000e FAD1     		bne	.L3
  94:Middlewares/Third_Party/ulibSD/sd_io.c ****     return(partial);
  95:Middlewares/Third_Party/ulibSD/sd_io.c **** }
  51              		.loc 1 95 0 is_stmt 1
  52 0010 1046     		mov	r0, r2
  53              	.LVL5:
  54 0012 7047     		bx	lr
  55              		.cfi_endproc
  56              	.LFE0:
  58              		.section	.text.__SD_Speed_Transfer,"ax",%progbits
  59              		.align	1
  60              		.global	__SD_Speed_Transfer
  61              		.syntax unified
  62              		.thumb
  63              		.thumb_func
  64              		.fpu softvfp
  66              	__SD_Speed_Transfer:
  67              	.LFB3:
  96:Middlewares/Third_Party/ulibSD/sd_io.c **** 
  97:Middlewares/Third_Party/ulibSD/sd_io.c **** inline void __SD_Assert(void){
  98:Middlewares/Third_Party/ulibSD/sd_io.c ****     SPI_CS_Low();
  99:Middlewares/Third_Party/ulibSD/sd_io.c **** }
 100:Middlewares/Third_Party/ulibSD/sd_io.c **** 
 101:Middlewares/Third_Party/ulibSD/sd_io.c **** inline void __SD_Deassert(void){
 102:Middlewares/Third_Party/ulibSD/sd_io.c ****     SPI_CS_High();
 103:Middlewares/Third_Party/ulibSD/sd_io.c **** }
 104:Middlewares/Third_Party/ulibSD/sd_io.c **** 
 105:Middlewares/Third_Party/ulibSD/sd_io.c **** void __SD_Speed_Transfer(BYTE throttle) {
  68              		.loc 1 105 0
ARM GAS  /tmp/cctRxqh5.s 			page 4


  69              		.cfi_startproc
  70              		@ args = 0, pretend = 0, frame = 0
  71              		@ frame_needed = 0, uses_anonymous_args = 0
  72              	.LVL6:
  73 0000 08B5     		push	{r3, lr}
  74              	.LCFI0:
  75              		.cfi_def_cfa_offset 8
  76              		.cfi_offset 3, -8
  77              		.cfi_offset 14, -4
 106:Middlewares/Third_Party/ulibSD/sd_io.c ****     if(throttle == HIGH) SPI_Freq_High();
  78              		.loc 1 106 0
  79 0002 0128     		cmp	r0, #1
  80 0004 02D0     		beq	.L8
 107:Middlewares/Third_Party/ulibSD/sd_io.c ****     else SPI_Freq_Low();
  81              		.loc 1 107 0
  82 0006 FFF7FEFF 		bl	SPI_Freq_Low
  83              	.LVL7:
  84 000a 08BD     		pop	{r3, pc}
  85              	.LVL8:
  86              	.L8:
 106:Middlewares/Third_Party/ulibSD/sd_io.c ****     if(throttle == HIGH) SPI_Freq_High();
  87              		.loc 1 106 0 discriminator 1
  88 000c FFF7FEFF 		bl	SPI_Freq_High
  89              	.LVL9:
  90 0010 08BD     		pop	{r3, pc}
  91              		.cfi_endproc
  92              	.LFE3:
  94              		.section	.text.__SD_Send_Cmd,"ax",%progbits
  95              		.align	1
  96              		.global	__SD_Send_Cmd
  97              		.syntax unified
  98              		.thumb
  99              		.thumb_func
 100              		.fpu softvfp
 102              	__SD_Send_Cmd:
 103              	.LFB4:
 108:Middlewares/Third_Party/ulibSD/sd_io.c **** }
 109:Middlewares/Third_Party/ulibSD/sd_io.c **** 
 110:Middlewares/Third_Party/ulibSD/sd_io.c **** BYTE __SD_Send_Cmd(BYTE cmd, DWORD arg)
 111:Middlewares/Third_Party/ulibSD/sd_io.c **** {
 104              		.loc 1 111 0
 105              		.cfi_startproc
 106              		@ args = 0, pretend = 0, frame = 0
 107              		@ frame_needed = 0, uses_anonymous_args = 0
 108              	.LVL10:
 109 0000 70B5     		push	{r4, r5, r6, lr}
 110              	.LCFI1:
 111              		.cfi_def_cfa_offset 16
 112              		.cfi_offset 4, -16
 113              		.cfi_offset 5, -12
 114              		.cfi_offset 6, -8
 115              		.cfi_offset 14, -4
 116 0002 0546     		mov	r5, r0
 117 0004 0E46     		mov	r6, r1
 112:Middlewares/Third_Party/ulibSD/sd_io.c ****     BYTE crc, res;
 113:Middlewares/Third_Party/ulibSD/sd_io.c ****     // ACMD«n» is the command sequense of CMD55-CMD«n»
 114:Middlewares/Third_Party/ulibSD/sd_io.c ****     if(cmd & 0x80) {
ARM GAS  /tmp/cctRxqh5.s 			page 5


 118              		.loc 1 114 0
 119 0006 10F0800F 		tst	r0, #128
 120 000a 33D1     		bne	.L19
 121              	.LVL11:
 122              	.L10:
 123              	.LBB6:
 124              	.LBB7:
 102:Middlewares/Third_Party/ulibSD/sd_io.c **** }
 125              		.loc 1 102 0
 126 000c FFF7FEFF 		bl	SPI_CS_High
 127              	.LVL12:
 128              	.LBE7:
 129              	.LBE6:
 115:Middlewares/Third_Party/ulibSD/sd_io.c ****         cmd &= 0x7F;
 116:Middlewares/Third_Party/ulibSD/sd_io.c ****         res = __SD_Send_Cmd(CMD55, 0);
 117:Middlewares/Third_Party/ulibSD/sd_io.c ****         if (res > 1) return (res);
 118:Middlewares/Third_Party/ulibSD/sd_io.c ****     }
 119:Middlewares/Third_Party/ulibSD/sd_io.c **** 
 120:Middlewares/Third_Party/ulibSD/sd_io.c ****     // Select the card
 121:Middlewares/Third_Party/ulibSD/sd_io.c ****     __SD_Deassert();
 122:Middlewares/Third_Party/ulibSD/sd_io.c ****     SPI_RW(0xFF);
 130              		.loc 1 122 0
 131 0010 FF20     		movs	r0, #255
 132 0012 FFF7FEFF 		bl	SPI_RW
 133              	.LVL13:
 134              	.LBB8:
 135              	.LBB9:
  98:Middlewares/Third_Party/ulibSD/sd_io.c **** }
 136              		.loc 1 98 0
 137 0016 FFF7FEFF 		bl	SPI_CS_Low
 138              	.LVL14:
 139              	.LBE9:
 140              	.LBE8:
 123:Middlewares/Third_Party/ulibSD/sd_io.c ****     __SD_Assert();
 124:Middlewares/Third_Party/ulibSD/sd_io.c ****     SPI_RW(0xFF);
 141              		.loc 1 124 0
 142 001a FF20     		movs	r0, #255
 143 001c FFF7FEFF 		bl	SPI_RW
 144              	.LVL15:
 125:Middlewares/Third_Party/ulibSD/sd_io.c **** 
 126:Middlewares/Third_Party/ulibSD/sd_io.c ****     // Send complete command set
 127:Middlewares/Third_Party/ulibSD/sd_io.c ****     SPI_RW(cmd);                        // Start and command index
 145              		.loc 1 127 0
 146 0020 2846     		mov	r0, r5
 147 0022 FFF7FEFF 		bl	SPI_RW
 148              	.LVL16:
 128:Middlewares/Third_Party/ulibSD/sd_io.c ****     SPI_RW((BYTE)(arg >> 24));          // Arg[31-24]
 149              		.loc 1 128 0
 150 0026 300E     		lsrs	r0, r6, #24
 151 0028 FFF7FEFF 		bl	SPI_RW
 152              	.LVL17:
 129:Middlewares/Third_Party/ulibSD/sd_io.c ****     SPI_RW((BYTE)(arg >> 16));          // Arg[23-16]
 153              		.loc 1 129 0
 154 002c C6F30740 		ubfx	r0, r6, #16, #8
 155 0030 FFF7FEFF 		bl	SPI_RW
 156              	.LVL18:
 130:Middlewares/Third_Party/ulibSD/sd_io.c ****     SPI_RW((BYTE)(arg >> 8 ));          // Arg[15-08]
ARM GAS  /tmp/cctRxqh5.s 			page 6


 157              		.loc 1 130 0
 158 0034 C6F30720 		ubfx	r0, r6, #8, #8
 159 0038 FFF7FEFF 		bl	SPI_RW
 160              	.LVL19:
 131:Middlewares/Third_Party/ulibSD/sd_io.c ****     SPI_RW((BYTE)(arg >> 0 ));          // Arg[07-00]
 161              		.loc 1 131 0
 162 003c F0B2     		uxtb	r0, r6
 163 003e FFF7FEFF 		bl	SPI_RW
 164              	.LVL20:
 132:Middlewares/Third_Party/ulibSD/sd_io.c **** 
 133:Middlewares/Third_Party/ulibSD/sd_io.c ****     // CRC?
 134:Middlewares/Third_Party/ulibSD/sd_io.c ****     crc = 0x01;                         // Dummy CRC and stop
 135:Middlewares/Third_Party/ulibSD/sd_io.c ****     if(cmd == CMD0) crc = 0x95;         // Valid CRC for CMD0(0)
 165              		.loc 1 135 0
 166 0042 402D     		cmp	r5, #64
 167 0044 20D0     		beq	.L16
 134:Middlewares/Third_Party/ulibSD/sd_io.c ****     if(cmd == CMD0) crc = 0x95;         // Valid CRC for CMD0(0)
 168              		.loc 1 134 0
 169 0046 0120     		movs	r0, #1
 170              	.L12:
 171              	.LVL21:
 136:Middlewares/Third_Party/ulibSD/sd_io.c ****     if(cmd == CMD8) crc = 0x87;         // Valid CRC for CMD8(0x1AA)
 172              		.loc 1 136 0
 173 0048 482D     		cmp	r5, #72
 174 004a 1FD0     		beq	.L20
 175              	.LVL22:
 176              	.L13:
 137:Middlewares/Third_Party/ulibSD/sd_io.c ****     SPI_RW(crc);
 177              		.loc 1 137 0
 178 004c FFF7FEFF 		bl	SPI_RW
 179              	.LVL23:
 138:Middlewares/Third_Party/ulibSD/sd_io.c **** 
 139:Middlewares/Third_Party/ulibSD/sd_io.c ****     // Receive command response
 140:Middlewares/Third_Party/ulibSD/sd_io.c ****     // Wait for a valid response in timeout of 5 milliseconds
 141:Middlewares/Third_Party/ulibSD/sd_io.c ****     SPI_Timer_On(5);
 180              		.loc 1 141 0
 181 0050 0520     		movs	r0, #5
 182 0052 FFF7FEFF 		bl	SPI_Timer_On
 183              	.LVL24:
 184              	.L15:
 142:Middlewares/Third_Party/ulibSD/sd_io.c ****     do {
 143:Middlewares/Third_Party/ulibSD/sd_io.c ****         res = SPI_RW(0xFF);
 185              		.loc 1 143 0 discriminator 2
 186 0056 FF20     		movs	r0, #255
 187 0058 FFF7FEFF 		bl	SPI_RW
 188              	.LVL25:
 189 005c 0446     		mov	r4, r0
 190              	.LVL26:
 144:Middlewares/Third_Party/ulibSD/sd_io.c ****     } while((res & 0x80)&&(SPI_Timer_Status()==TRUE));
 191              		.loc 1 144 0 discriminator 2
 192 005e 10F0800F 		tst	r0, #128
 193 0062 03D0     		beq	.L14
 194              		.loc 1 144 0 is_stmt 0 discriminator 1
 195 0064 FFF7FEFF 		bl	SPI_Timer_Status
 196              	.LVL27:
 197 0068 0128     		cmp	r0, #1
 198 006a F4D0     		beq	.L15
ARM GAS  /tmp/cctRxqh5.s 			page 7


 199              	.L14:
 145:Middlewares/Third_Party/ulibSD/sd_io.c ****     SPI_Timer_Off();
 200              		.loc 1 145 0 is_stmt 1
 201 006c FFF7FEFF 		bl	SPI_Timer_Off
 202              	.LVL28:
 203              	.L11:
 146:Middlewares/Third_Party/ulibSD/sd_io.c ****     // Return with the response value
 147:Middlewares/Third_Party/ulibSD/sd_io.c ****     return(res);
 148:Middlewares/Third_Party/ulibSD/sd_io.c **** }
 204              		.loc 1 148 0
 205 0070 2046     		mov	r0, r4
 206 0072 70BD     		pop	{r4, r5, r6, pc}
 207              	.LVL29:
 208              	.L19:
 115:Middlewares/Third_Party/ulibSD/sd_io.c ****         res = __SD_Send_Cmd(CMD55, 0);
 209              		.loc 1 115 0
 210 0074 00F07F05 		and	r5, r0, #127
 211              	.LVL30:
 116:Middlewares/Third_Party/ulibSD/sd_io.c ****         if (res > 1) return (res);
 212              		.loc 1 116 0
 213 0078 0021     		movs	r1, #0
 214              	.LVL31:
 215 007a 7720     		movs	r0, #119
 216 007c FFF7FEFF 		bl	__SD_Send_Cmd
 217              	.LVL32:
 218 0080 0446     		mov	r4, r0
 219              	.LVL33:
 117:Middlewares/Third_Party/ulibSD/sd_io.c ****     }
 220              		.loc 1 117 0
 221 0082 0128     		cmp	r0, #1
 222 0084 F4D8     		bhi	.L11
 223 0086 C1E7     		b	.L10
 224              	.LVL34:
 225              	.L16:
 135:Middlewares/Third_Party/ulibSD/sd_io.c ****     if(cmd == CMD8) crc = 0x87;         // Valid CRC for CMD8(0x1AA)
 226              		.loc 1 135 0
 227 0088 9520     		movs	r0, #149
 228 008a DDE7     		b	.L12
 229              	.LVL35:
 230              	.L20:
 136:Middlewares/Third_Party/ulibSD/sd_io.c ****     SPI_RW(crc);
 231              		.loc 1 136 0
 232 008c 8720     		movs	r0, #135
 233              	.LVL36:
 234 008e DDE7     		b	.L13
 235              		.cfi_endproc
 236              	.LFE4:
 238              		.section	.text.__SD_Write_Block,"ax",%progbits
 239              		.align	1
 240              		.global	__SD_Write_Block
 241              		.syntax unified
 242              		.thumb
 243              		.thumb_func
 244              		.fpu softvfp
 246              	__SD_Write_Block:
 247              	.LFB5:
 149:Middlewares/Third_Party/ulibSD/sd_io.c **** 
ARM GAS  /tmp/cctRxqh5.s 			page 8


 150:Middlewares/Third_Party/ulibSD/sd_io.c **** SDRESULTS __SD_Write_Block(SD_DEV *dev, void *dat, BYTE token)
 151:Middlewares/Third_Party/ulibSD/sd_io.c **** {
 248              		.loc 1 151 0
 249              		.cfi_startproc
 250              		@ args = 0, pretend = 0, frame = 0
 251              		@ frame_needed = 0, uses_anonymous_args = 0
 252              	.LVL37:
 253 0000 38B5     		push	{r3, r4, r5, lr}
 254              	.LCFI2:
 255              		.cfi_def_cfa_offset 16
 256              		.cfi_offset 3, -16
 257              		.cfi_offset 4, -12
 258              		.cfi_offset 5, -8
 259              		.cfi_offset 14, -4
 260 0002 0D46     		mov	r5, r1
 261 0004 1446     		mov	r4, r2
 152:Middlewares/Third_Party/ulibSD/sd_io.c ****     WORD idx;
 153:Middlewares/Third_Party/ulibSD/sd_io.c ****     BYTE line;
 154:Middlewares/Third_Party/ulibSD/sd_io.c ****     // Send token (single or multiple)
 155:Middlewares/Third_Party/ulibSD/sd_io.c ****     SPI_RW(token);
 262              		.loc 1 155 0
 263 0006 1046     		mov	r0, r2
 264              	.LVL38:
 265 0008 FFF7FEFF 		bl	SPI_RW
 266              	.LVL39:
 156:Middlewares/Third_Party/ulibSD/sd_io.c ****     // Single block write?
 157:Middlewares/Third_Party/ulibSD/sd_io.c ****     if(token != 0xFD)
 267              		.loc 1 157 0
 268 000c FD2C     		cmp	r4, #253
 269 000e 18D0     		beq	.L23
 270 0010 0024     		movs	r4, #0
 271 0012 04E0     		b	.L22
 272              	.LVL40:
 273              	.L24:
 158:Middlewares/Third_Party/ulibSD/sd_io.c ****     {
 159:Middlewares/Third_Party/ulibSD/sd_io.c ****         // Send block data
 160:Middlewares/Third_Party/ulibSD/sd_io.c ****         for(idx=0; idx!=SD_BLK_SIZE; idx++) SPI_RW(*((BYTE*)dat + idx));
 274              		.loc 1 160 0 discriminator 3
 275 0014 285D     		ldrb	r0, [r5, r4]	@ zero_extendqisi2
 276 0016 FFF7FEFF 		bl	SPI_RW
 277              	.LVL41:
 278 001a 0134     		adds	r4, r4, #1
 279              	.LVL42:
 280 001c A4B2     		uxth	r4, r4
 281              	.LVL43:
 282              	.L22:
 283              		.loc 1 160 0 is_stmt 0 discriminator 1
 284 001e B4F5007F 		cmp	r4, #512
 285 0022 F7D1     		bne	.L24
 161:Middlewares/Third_Party/ulibSD/sd_io.c ****         /* Dummy CRC */
 162:Middlewares/Third_Party/ulibSD/sd_io.c ****         SPI_RW(0xFF);
 286              		.loc 1 162 0 is_stmt 1
 287 0024 FF20     		movs	r0, #255
 288 0026 FFF7FEFF 		bl	SPI_RW
 289              	.LVL44:
 163:Middlewares/Third_Party/ulibSD/sd_io.c ****         SPI_RW(0xFF);
 290              		.loc 1 163 0
ARM GAS  /tmp/cctRxqh5.s 			page 9


 291 002a FF20     		movs	r0, #255
 292 002c FFF7FEFF 		bl	SPI_RW
 293              	.LVL45:
 164:Middlewares/Third_Party/ulibSD/sd_io.c ****         // If not accepted, returns the reject error
 165:Middlewares/Third_Party/ulibSD/sd_io.c ****         if((SPI_RW(0xFF) & 0x1F) != 0x05) return(SD_REJECT);
 294              		.loc 1 165 0
 295 0030 FF20     		movs	r0, #255
 296 0032 FFF7FEFF 		bl	SPI_RW
 297              	.LVL46:
 298 0036 00F01F00 		and	r0, r0, #31
 299 003a 0528     		cmp	r0, #5
 300 003c 01D0     		beq	.L23
 301 003e 0520     		movs	r0, #5
 302 0040 38BD     		pop	{r3, r4, r5, pc}
 303              	.LVL47:
 304              	.L23:
 166:Middlewares/Third_Party/ulibSD/sd_io.c ****     }
 167:Middlewares/Third_Party/ulibSD/sd_io.c **** #ifdef SD_IO_WRITE_WAIT_BLOCKER
 168:Middlewares/Third_Party/ulibSD/sd_io.c ****     // Waits until finish of data programming (blocked)
 169:Middlewares/Third_Party/ulibSD/sd_io.c ****     while(SPI_RW(0xFF)==0);
 170:Middlewares/Third_Party/ulibSD/sd_io.c ****     return(SD_OK);
 171:Middlewares/Third_Party/ulibSD/sd_io.c **** #else
 172:Middlewares/Third_Party/ulibSD/sd_io.c ****     // Waits until finish of data programming with a timeout
 173:Middlewares/Third_Party/ulibSD/sd_io.c ****     SPI_Timer_On(SD_IO_WRITE_TIMEOUT_WAIT);
 305              		.loc 1 173 0
 306 0042 FA20     		movs	r0, #250
 307 0044 FFF7FEFF 		bl	SPI_Timer_On
 308              	.LVL48:
 309              	.L27:
 174:Middlewares/Third_Party/ulibSD/sd_io.c ****     do {
 175:Middlewares/Third_Party/ulibSD/sd_io.c ****         line = SPI_RW(0xFF);
 310              		.loc 1 175 0 discriminator 2
 311 0048 FF20     		movs	r0, #255
 312 004a FFF7FEFF 		bl	SPI_RW
 313              	.LVL49:
 176:Middlewares/Third_Party/ulibSD/sd_io.c ****     } while((line==0)&&(SPI_Timer_Status()==TRUE));
 314              		.loc 1 176 0 discriminator 2
 315 004e 0446     		mov	r4, r0
 316 0050 18B9     		cbnz	r0, .L26
 317              		.loc 1 176 0 is_stmt 0 discriminator 1
 318 0052 FFF7FEFF 		bl	SPI_Timer_Status
 319              	.LVL50:
 320 0056 0128     		cmp	r0, #1
 321 0058 F6D0     		beq	.L27
 322              	.L26:
 177:Middlewares/Third_Party/ulibSD/sd_io.c ****     SPI_Timer_Off();
 323              		.loc 1 177 0 is_stmt 1
 324 005a FFF7FEFF 		bl	SPI_Timer_Off
 325              	.LVL51:
 178:Middlewares/Third_Party/ulibSD/sd_io.c **** #ifdef SD_IO_DBG_COUNT
 179:Middlewares/Third_Party/ulibSD/sd_io.c ****     dev->debug.write++;
 180:Middlewares/Third_Party/ulibSD/sd_io.c **** #endif
 181:Middlewares/Third_Party/ulibSD/sd_io.c ****     if(line==0) return(SD_BUSY);
 326              		.loc 1 181 0
 327 005e 0CB9     		cbnz	r4, .L30
 328 0060 0420     		movs	r0, #4
 329 0062 38BD     		pop	{r3, r4, r5, pc}
ARM GAS  /tmp/cctRxqh5.s 			page 10


 330              	.LVL52:
 331              	.L30:
 182:Middlewares/Third_Party/ulibSD/sd_io.c ****     else return(SD_OK);
 332              		.loc 1 182 0
 333 0064 0020     		movs	r0, #0
 183:Middlewares/Third_Party/ulibSD/sd_io.c **** #endif
 184:Middlewares/Third_Party/ulibSD/sd_io.c **** }
 334              		.loc 1 184 0
 335 0066 38BD     		pop	{r3, r4, r5, pc}
 336              		.cfi_endproc
 337              	.LFE5:
 339              		.section	.text.__SD_Sectors,"ax",%progbits
 340              		.align	1
 341              		.global	__SD_Sectors
 342              		.syntax unified
 343              		.thumb
 344              		.thumb_func
 345              		.fpu softvfp
 347              	__SD_Sectors:
 348              	.LFB6:
 185:Middlewares/Third_Party/ulibSD/sd_io.c **** 
 186:Middlewares/Third_Party/ulibSD/sd_io.c **** DWORD __SD_Sectors (SD_DEV *dev)
 187:Middlewares/Third_Party/ulibSD/sd_io.c **** {
 349              		.loc 1 187 0
 350              		.cfi_startproc
 351              		@ args = 0, pretend = 0, frame = 16
 352              		@ frame_needed = 0, uses_anonymous_args = 0
 353              	.LVL53:
 354 0000 70B5     		push	{r4, r5, r6, lr}
 355              	.LCFI3:
 356              		.cfi_def_cfa_offset 16
 357              		.cfi_offset 4, -16
 358              		.cfi_offset 5, -12
 359              		.cfi_offset 6, -8
 360              		.cfi_offset 14, -4
 361 0002 84B0     		sub	sp, sp, #16
 362              	.LCFI4:
 363              		.cfi_def_cfa_offset 32
 364 0004 0646     		mov	r6, r0
 365              	.LVL54:
 188:Middlewares/Third_Party/ulibSD/sd_io.c ****     BYTE csd[16];
 189:Middlewares/Third_Party/ulibSD/sd_io.c ****     BYTE idx;
 190:Middlewares/Third_Party/ulibSD/sd_io.c ****     DWORD ss = 0;
 191:Middlewares/Third_Party/ulibSD/sd_io.c ****     WORD C_SIZE = 0;
 192:Middlewares/Third_Party/ulibSD/sd_io.c ****     BYTE C_SIZE_MULT = 0;
 193:Middlewares/Third_Party/ulibSD/sd_io.c ****     BYTE READ_BL_LEN = 0;
 194:Middlewares/Third_Party/ulibSD/sd_io.c ****     if(__SD_Send_Cmd(CMD9, 0)==0) 
 366              		.loc 1 194 0
 367 0006 0021     		movs	r1, #0
 368 0008 4920     		movs	r0, #73
 369              	.LVL55:
 370 000a FFF7FEFF 		bl	__SD_Send_Cmd
 371              	.LVL56:
 372 000e 0546     		mov	r5, r0
 373 0010 0028     		cmp	r0, #0
 374 0012 5BD1     		bne	.L39
 375              	.L34:
ARM GAS  /tmp/cctRxqh5.s 			page 11


 195:Middlewares/Third_Party/ulibSD/sd_io.c ****     {
 196:Middlewares/Third_Party/ulibSD/sd_io.c ****         // Wait for response
 197:Middlewares/Third_Party/ulibSD/sd_io.c ****         while (SPI_RW(0xFF) == 0xFF);
 376              		.loc 1 197 0 discriminator 1
 377 0014 FF20     		movs	r0, #255
 378 0016 FFF7FEFF 		bl	SPI_RW
 379              	.LVL57:
 380 001a FF28     		cmp	r0, #255
 381 001c FAD0     		beq	.L34
 382 001e 2C46     		mov	r4, r5
 383 0020 08E0     		b	.L35
 384              	.LVL58:
 385              	.L36:
 198:Middlewares/Third_Party/ulibSD/sd_io.c ****         for (idx=0; idx!=16; idx++) csd[idx] = SPI_RW(0xFF);
 386              		.loc 1 198 0 discriminator 3
 387 0022 FF20     		movs	r0, #255
 388 0024 FFF7FEFF 		bl	SPI_RW
 389              	.LVL59:
 390 0028 04AB     		add	r3, sp, #16
 391 002a 2344     		add	r3, r3, r4
 392 002c 03F8100C 		strb	r0, [r3, #-16]
 393 0030 0134     		adds	r4, r4, #1
 394              	.LVL60:
 395 0032 E4B2     		uxtb	r4, r4
 396              	.LVL61:
 397              	.L35:
 398              		.loc 1 198 0 is_stmt 0 discriminator 1
 399 0034 102C     		cmp	r4, #16
 400 0036 F4D1     		bne	.L36
 199:Middlewares/Third_Party/ulibSD/sd_io.c ****         // Dummy CRC
 200:Middlewares/Third_Party/ulibSD/sd_io.c ****         SPI_RW(0xFF);
 401              		.loc 1 200 0 is_stmt 1
 402 0038 FF20     		movs	r0, #255
 403 003a FFF7FEFF 		bl	SPI_RW
 404              	.LVL62:
 201:Middlewares/Third_Party/ulibSD/sd_io.c ****         SPI_RW(0xFF);
 405              		.loc 1 201 0
 406 003e FF20     		movs	r0, #255
 407 0040 FFF7FEFF 		bl	SPI_RW
 408              	.LVL63:
 202:Middlewares/Third_Party/ulibSD/sd_io.c ****         SPI_Release();
 409              		.loc 1 202 0
 410 0044 FFF7FEFF 		bl	SPI_Release
 411              	.LVL64:
 203:Middlewares/Third_Party/ulibSD/sd_io.c ****         if(dev->cardtype & SDCT_SD1)
 412              		.loc 1 203 0
 413 0048 7378     		ldrb	r3, [r6, #1]	@ zero_extendqisi2
 414 004a 13F0020F 		tst	r3, #2
 415 004e 28D0     		beq	.L37
 416              	.LVL65:
 204:Middlewares/Third_Party/ulibSD/sd_io.c ****         {
 205:Middlewares/Third_Party/ulibSD/sd_io.c ****             ss = csd[0];
 206:Middlewares/Third_Party/ulibSD/sd_io.c ****             // READ_BL_LEN[83:80]: max. read data block length
 207:Middlewares/Third_Party/ulibSD/sd_io.c ****             READ_BL_LEN = (csd[5] & 0x0F);
 417              		.loc 1 207 0
 418 0050 9DF80560 		ldrb	r6, [sp, #5]	@ zero_extendqisi2
 419              	.LVL66:
ARM GAS  /tmp/cctRxqh5.s 			page 12


 420 0054 06F00F06 		and	r6, r6, #15
 421              	.LVL67:
 208:Middlewares/Third_Party/ulibSD/sd_io.c ****             // C_SIZE [73:62]
 209:Middlewares/Third_Party/ulibSD/sd_io.c ****             C_SIZE = (csd[6] & 0x03);
 422              		.loc 1 209 0
 423 0058 9DF80630 		ldrb	r3, [sp, #6]	@ zero_extendqisi2
 424 005c 03F00303 		and	r3, r3, #3
 425              	.LVL68:
 210:Middlewares/Third_Party/ulibSD/sd_io.c ****             C_SIZE <<= 8;
 211:Middlewares/Third_Party/ulibSD/sd_io.c ****             C_SIZE |= (csd[7]);
 426              		.loc 1 211 0
 427 0060 9DF80740 		ldrb	r4, [sp, #7]	@ zero_extendqisi2
 428              	.LVL69:
 429 0064 44EA0323 		orr	r3, r4, r3, lsl #8
 430              	.LVL70:
 212:Middlewares/Third_Party/ulibSD/sd_io.c ****             C_SIZE <<= 2;
 213:Middlewares/Third_Party/ulibSD/sd_io.c ****             C_SIZE |= ((csd[8] >> 6) & 0x03);
 431              		.loc 1 213 0
 432 0068 9DF80840 		ldrb	r4, [sp, #8]	@ zero_extendqisi2
 433 006c A409     		lsrs	r4, r4, #6
 434 006e 44EA8304 		orr	r4, r4, r3, lsl #2
 435              	.LVL71:
 214:Middlewares/Third_Party/ulibSD/sd_io.c ****             // C_SIZE_MULT [49:47]
 215:Middlewares/Third_Party/ulibSD/sd_io.c ****             C_SIZE_MULT = (csd[9] & 0x03);
 436              		.loc 1 215 0
 437 0072 9DF80950 		ldrb	r5, [sp, #9]	@ zero_extendqisi2
 438              	.LVL72:
 216:Middlewares/Third_Party/ulibSD/sd_io.c ****             C_SIZE_MULT <<= 1;
 439              		.loc 1 216 0
 440 0076 6D00     		lsls	r5, r5, #1
 441              	.LVL73:
 442 0078 05F00605 		and	r5, r5, #6
 443              	.LVL74:
 217:Middlewares/Third_Party/ulibSD/sd_io.c ****             C_SIZE_MULT |= ((csd[10] >> 7) & 0x01);
 444              		.loc 1 217 0
 445 007c 9DF80A00 		ldrb	r0, [sp, #10]	@ zero_extendqisi2
 446 0080 45EAD015 		orr	r5, r5, r0, lsr #7
 447              	.LVL75:
 448              	.L38:
 218:Middlewares/Third_Party/ulibSD/sd_io.c ****         }
 219:Middlewares/Third_Party/ulibSD/sd_io.c ****         else if(dev->cardtype & SDCT_SD2)
 220:Middlewares/Third_Party/ulibSD/sd_io.c ****         {
 221:Middlewares/Third_Party/ulibSD/sd_io.c ****             // C_SIZE [69:48]
 222:Middlewares/Third_Party/ulibSD/sd_io.c ****             C_SIZE = (csd[7] & 0x3F);
 223:Middlewares/Third_Party/ulibSD/sd_io.c ****             C_SIZE <<= 8;
 224:Middlewares/Third_Party/ulibSD/sd_io.c ****             C_SIZE |= (csd[8] & 0xFF);
 225:Middlewares/Third_Party/ulibSD/sd_io.c ****             C_SIZE <<= 8;
 226:Middlewares/Third_Party/ulibSD/sd_io.c ****             C_SIZE |= (csd[9] & 0xFF);
 227:Middlewares/Third_Party/ulibSD/sd_io.c ****             // C_SIZE_MULT [--]. don't exits
 228:Middlewares/Third_Party/ulibSD/sd_io.c ****             C_SIZE_MULT = 0;
 229:Middlewares/Third_Party/ulibSD/sd_io.c ****         }
 230:Middlewares/Third_Party/ulibSD/sd_io.c ****         ss = (C_SIZE + 1);
 449              		.loc 1 230 0
 450 0084 0134     		adds	r4, r4, #1
 451              	.LVL76:
 231:Middlewares/Third_Party/ulibSD/sd_io.c ****         ss *= __SD_Power_Of_Two(C_SIZE_MULT + 2);
 452              		.loc 1 231 0
ARM GAS  /tmp/cctRxqh5.s 			page 13


 453 0086 A81C     		adds	r0, r5, #2
 454 0088 C0B2     		uxtb	r0, r0
 455 008a FFF7FEFF 		bl	__SD_Power_Of_Two
 456              	.LVL77:
 457 008e 00FB04F4 		mul	r4, r0, r4
 458              	.LVL78:
 232:Middlewares/Third_Party/ulibSD/sd_io.c ****         ss *= __SD_Power_Of_Two(READ_BL_LEN);
 459              		.loc 1 232 0
 460 0092 3046     		mov	r0, r6
 461 0094 FFF7FEFF 		bl	__SD_Power_Of_Two
 462              	.LVL79:
 463 0098 00FB04F0 		mul	r0, r0, r4
 464              	.LVL80:
 233:Middlewares/Third_Party/ulibSD/sd_io.c ****         ss /= SD_BLK_SIZE;
 465              		.loc 1 233 0
 466 009c 400A     		lsrs	r0, r0, #9
 467              	.LVL81:
 468              	.L32:
 234:Middlewares/Third_Party/ulibSD/sd_io.c ****         return (ss);
 235:Middlewares/Third_Party/ulibSD/sd_io.c ****     } else return (0); // Error
 236:Middlewares/Third_Party/ulibSD/sd_io.c **** }
 469              		.loc 1 236 0
 470 009e 04B0     		add	sp, sp, #16
 471              	.LCFI5:
 472              		.cfi_remember_state
 473              		.cfi_def_cfa_offset 16
 474              		@ sp needed
 475 00a0 70BD     		pop	{r4, r5, r6, pc}
 476              	.LVL82:
 477              	.L37:
 478              	.LCFI6:
 479              		.cfi_restore_state
 219:Middlewares/Third_Party/ulibSD/sd_io.c ****         {
 480              		.loc 1 219 0
 481 00a2 13F0040F 		tst	r3, #4
 482 00a6 0ED0     		beq	.L40
 222:Middlewares/Third_Party/ulibSD/sd_io.c ****             C_SIZE <<= 8;
 483              		.loc 1 222 0
 484 00a8 9DF80730 		ldrb	r3, [sp, #7]	@ zero_extendqisi2
 485 00ac 03F03F03 		and	r3, r3, #63
 486              	.LVL83:
 224:Middlewares/Third_Party/ulibSD/sd_io.c ****             C_SIZE <<= 8;
 487              		.loc 1 224 0
 488 00b0 9DF80840 		ldrb	r4, [sp, #8]	@ zero_extendqisi2
 489              	.LVL84:
 490 00b4 44EA0324 		orr	r4, r4, r3, lsl #8
 491              	.LVL85:
 225:Middlewares/Third_Party/ulibSD/sd_io.c ****             C_SIZE |= (csd[9] & 0xFF);
 492              		.loc 1 225 0
 493 00b8 2402     		lsls	r4, r4, #8
 494              	.LVL86:
 495 00ba A4B2     		uxth	r4, r4
 496              	.LVL87:
 226:Middlewares/Third_Party/ulibSD/sd_io.c ****             // C_SIZE_MULT [--]. don't exits
 497              		.loc 1 226 0
 498 00bc 9DF80930 		ldrb	r3, [sp, #9]	@ zero_extendqisi2
 499 00c0 1C43     		orrs	r4, r4, r3
ARM GAS  /tmp/cctRxqh5.s 			page 14


 500              	.LVL88:
 193:Middlewares/Third_Party/ulibSD/sd_io.c ****     if(__SD_Send_Cmd(CMD9, 0)==0) 
 501              		.loc 1 193 0
 502 00c2 2E46     		mov	r6, r5
 503              	.LVL89:
 504 00c4 DEE7     		b	.L38
 505              	.LVL90:
 506              	.L40:
 507 00c6 2E46     		mov	r6, r5
 508              	.LVL91:
 191:Middlewares/Third_Party/ulibSD/sd_io.c ****     BYTE C_SIZE_MULT = 0;
 509              		.loc 1 191 0
 510 00c8 0024     		movs	r4, #0
 511              	.LVL92:
 512 00ca DBE7     		b	.L38
 513              	.LVL93:
 514              	.L39:
 235:Middlewares/Third_Party/ulibSD/sd_io.c **** }
 515              		.loc 1 235 0
 516 00cc 0020     		movs	r0, #0
 517 00ce E6E7     		b	.L32
 518              		.cfi_endproc
 519              	.LFE6:
 521              		.section	.text.SD_Init,"ax",%progbits
 522              		.align	1
 523              		.global	SD_Init
 524              		.syntax unified
 525              		.thumb
 526              		.thumb_func
 527              		.fpu softvfp
 529              	SD_Init:
 530              	.LFB7:
 237:Middlewares/Third_Party/ulibSD/sd_io.c **** #endif // Private methods for uC
 238:Middlewares/Third_Party/ulibSD/sd_io.c **** 
 239:Middlewares/Third_Party/ulibSD/sd_io.c **** /******************************************************************************
 240:Middlewares/Third_Party/ulibSD/sd_io.c ****  Public Methods - Direct work with SD card
 241:Middlewares/Third_Party/ulibSD/sd_io.c **** ******************************************************************************/
 242:Middlewares/Third_Party/ulibSD/sd_io.c **** 
 243:Middlewares/Third_Party/ulibSD/sd_io.c **** SDRESULTS SD_Init(SD_DEV *dev)
 244:Middlewares/Third_Party/ulibSD/sd_io.c **** {
 531              		.loc 1 244 0
 532              		.cfi_startproc
 533              		@ args = 0, pretend = 0, frame = 8
 534              		@ frame_needed = 0, uses_anonymous_args = 0
 535              	.LVL94:
 536 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 537              	.LCFI7:
 538              		.cfi_def_cfa_offset 24
 539              		.cfi_offset 4, -24
 540              		.cfi_offset 5, -20
 541              		.cfi_offset 6, -16
 542              		.cfi_offset 7, -12
 543              		.cfi_offset 8, -8
 544              		.cfi_offset 14, -4
 545 0004 82B0     		sub	sp, sp, #8
 546              	.LCFI8:
 547              		.cfi_def_cfa_offset 32
ARM GAS  /tmp/cctRxqh5.s 			page 15


 548 0006 0746     		mov	r7, r0
 549              	.LVL95:
 245:Middlewares/Third_Party/ulibSD/sd_io.c **** #if defined(_M_IX86)    // x86 
 246:Middlewares/Third_Party/ulibSD/sd_io.c ****     dev->fp = fopen(dev->fn, "r+");
 247:Middlewares/Third_Party/ulibSD/sd_io.c ****     if (dev->fp == NULL)
 248:Middlewares/Third_Party/ulibSD/sd_io.c ****         return (SD_ERROR);
 249:Middlewares/Third_Party/ulibSD/sd_io.c ****     else
 250:Middlewares/Third_Party/ulibSD/sd_io.c ****     {
 251:Middlewares/Third_Party/ulibSD/sd_io.c ****         dev->last_sector = __SD_Sectors(dev);
 252:Middlewares/Third_Party/ulibSD/sd_io.c **** #ifdef SD_IO_DBG_COUNT
 253:Middlewares/Third_Party/ulibSD/sd_io.c ****         dev->debug.read = 0;
 254:Middlewares/Third_Party/ulibSD/sd_io.c ****         dev->debug.write = 0;
 255:Middlewares/Third_Party/ulibSD/sd_io.c **** #endif
 256:Middlewares/Third_Party/ulibSD/sd_io.c ****         return (SD_OK);
 257:Middlewares/Third_Party/ulibSD/sd_io.c ****     }
 258:Middlewares/Third_Party/ulibSD/sd_io.c **** #else   // uControllers
 259:Middlewares/Third_Party/ulibSD/sd_io.c ****     BYTE n, cmd, ct, ocr[4];
 260:Middlewares/Third_Party/ulibSD/sd_io.c ****     BYTE idx;
 261:Middlewares/Third_Party/ulibSD/sd_io.c ****     BYTE init_trys;
 262:Middlewares/Third_Party/ulibSD/sd_io.c ****     ct = 0;
 263:Middlewares/Third_Party/ulibSD/sd_io.c ****     for(init_trys=0; ((init_trys!=SD_INIT_TRYS)&&(!ct)); init_trys++)
 550              		.loc 1 263 0
 551 0008 0025     		movs	r5, #0
 262:Middlewares/Third_Party/ulibSD/sd_io.c ****     for(init_trys=0; ((init_trys!=SD_INIT_TRYS)&&(!ct)); init_trys++)
 552              		.loc 1 262 0
 553 000a 2E46     		mov	r6, r5
 554              		.loc 1 263 0
 555 000c 2BE0     		b	.L43
 556              	.LVL96:
 557              	.L45:
 264:Middlewares/Third_Party/ulibSD/sd_io.c ****     {
 265:Middlewares/Third_Party/ulibSD/sd_io.c ****         // Initialize SPI for use with the memory card
 266:Middlewares/Third_Party/ulibSD/sd_io.c ****         SPI_Init();
 267:Middlewares/Third_Party/ulibSD/sd_io.c **** 
 268:Middlewares/Third_Party/ulibSD/sd_io.c ****         SPI_CS_High();
 269:Middlewares/Third_Party/ulibSD/sd_io.c ****         SPI_Freq_Low();
 270:Middlewares/Third_Party/ulibSD/sd_io.c **** 
 271:Middlewares/Third_Party/ulibSD/sd_io.c ****         // 80 dummy clocks
 272:Middlewares/Third_Party/ulibSD/sd_io.c ****         for(idx = 0; idx != 10; idx++) SPI_RW(0xFF);
 558              		.loc 1 272 0 discriminator 3
 559 000e FF20     		movs	r0, #255
 560 0010 FFF7FEFF 		bl	SPI_RW
 561              	.LVL97:
 562 0014 0134     		adds	r4, r4, #1
 563              	.LVL98:
 564 0016 E4B2     		uxtb	r4, r4
 565              	.LVL99:
 566              	.L44:
 567              		.loc 1 272 0 is_stmt 0 discriminator 1
 568 0018 0A2C     		cmp	r4, #10
 569 001a F8D1     		bne	.L45
 273:Middlewares/Third_Party/ulibSD/sd_io.c **** 
 274:Middlewares/Third_Party/ulibSD/sd_io.c ****         SPI_Timer_On(500);
 570              		.loc 1 274 0 is_stmt 1
 571 001c 4FF4FA70 		mov	r0, #500
 572 0020 FFF7FEFF 		bl	SPI_Timer_On
 573              	.LVL100:
ARM GAS  /tmp/cctRxqh5.s 			page 16


 574              	.L46:
 275:Middlewares/Third_Party/ulibSD/sd_io.c ****         while(SPI_Timer_Status()==TRUE);
 575              		.loc 1 275 0 discriminator 1
 576 0024 FFF7FEFF 		bl	SPI_Timer_Status
 577              	.LVL101:
 578 0028 0128     		cmp	r0, #1
 579 002a FBD0     		beq	.L46
 276:Middlewares/Third_Party/ulibSD/sd_io.c ****         SPI_Timer_Off();
 580              		.loc 1 276 0
 581 002c FFF7FEFF 		bl	SPI_Timer_Off
 582              	.LVL102:
 277:Middlewares/Third_Party/ulibSD/sd_io.c **** 
 278:Middlewares/Third_Party/ulibSD/sd_io.c ****         dev->mount = FALSE;
 583              		.loc 1 278 0
 584 0030 0023     		movs	r3, #0
 585 0032 3B70     		strb	r3, [r7]
 279:Middlewares/Third_Party/ulibSD/sd_io.c ****         SPI_Timer_On(500);
 586              		.loc 1 279 0
 587 0034 4FF4FA70 		mov	r0, #500
 588 0038 FFF7FEFF 		bl	SPI_Timer_On
 589              	.LVL103:
 590              	.L48:
 280:Middlewares/Third_Party/ulibSD/sd_io.c ****         while ((__SD_Send_Cmd(CMD0, 0) != 1)&&(SPI_Timer_Status()==TRUE));
 591              		.loc 1 280 0 discriminator 2
 592 003c 0021     		movs	r1, #0
 593 003e 4020     		movs	r0, #64
 594 0040 FFF7FEFF 		bl	__SD_Send_Cmd
 595              	.LVL104:
 596 0044 0128     		cmp	r0, #1
 597 0046 03D0     		beq	.L47
 598              		.loc 1 280 0 is_stmt 0 discriminator 1
 599 0048 FFF7FEFF 		bl	SPI_Timer_Status
 600              	.LVL105:
 601 004c 0128     		cmp	r0, #1
 602 004e F5D0     		beq	.L48
 603              	.L47:
 281:Middlewares/Third_Party/ulibSD/sd_io.c ****         SPI_Timer_Off();
 604              		.loc 1 281 0 is_stmt 1
 605 0050 FFF7FEFF 		bl	SPI_Timer_Off
 606              	.LVL106:
 282:Middlewares/Third_Party/ulibSD/sd_io.c ****         // Idle state
 283:Middlewares/Third_Party/ulibSD/sd_io.c ****         if (__SD_Send_Cmd(CMD0, 0) == 1) {                      
 607              		.loc 1 283 0
 608 0054 0021     		movs	r1, #0
 609 0056 4020     		movs	r0, #64
 610 0058 FFF7FEFF 		bl	__SD_Send_Cmd
 611              	.LVL107:
 612 005c 0446     		mov	r4, r0
 613              	.LVL108:
 614 005e 0128     		cmp	r0, #1
 615 0060 0FD0     		beq	.L72
 616              	.LVL109:
 617              	.L49:
 263:Middlewares/Third_Party/ulibSD/sd_io.c ****     {
 618              		.loc 1 263 0 discriminator 2
 619 0062 0135     		adds	r5, r5, #1
 620              	.LVL110:
ARM GAS  /tmp/cctRxqh5.s 			page 17


 621 0064 EDB2     		uxtb	r5, r5
 622              	.LVL111:
 623              	.L43:
 263:Middlewares/Third_Party/ulibSD/sd_io.c ****     {
 624              		.loc 1 263 0 is_stmt 0 discriminator 1
 625 0066 032D     		cmp	r5, #3
 626 0068 00F08580 		beq	.L62
 263:Middlewares/Third_Party/ulibSD/sd_io.c ****     {
 627              		.loc 1 263 0 discriminator 3
 628 006c 002E     		cmp	r6, #0
 629 006e 40F08280 		bne	.L62
 266:Middlewares/Third_Party/ulibSD/sd_io.c **** 
 630              		.loc 1 266 0 is_stmt 1
 631 0072 FFF7FEFF 		bl	SPI_Init
 632              	.LVL112:
 268:Middlewares/Third_Party/ulibSD/sd_io.c ****         SPI_Freq_Low();
 633              		.loc 1 268 0
 634 0076 FFF7FEFF 		bl	SPI_CS_High
 635              	.LVL113:
 269:Middlewares/Third_Party/ulibSD/sd_io.c **** 
 636              		.loc 1 269 0
 637 007a FFF7FEFF 		bl	SPI_Freq_Low
 638              	.LVL114:
 272:Middlewares/Third_Party/ulibSD/sd_io.c **** 
 639              		.loc 1 272 0
 640 007e 3446     		mov	r4, r6
 641 0080 CAE7     		b	.L44
 642              	.LVL115:
 643              	.L72:
 284:Middlewares/Third_Party/ulibSD/sd_io.c ****             // SD version 2?
 285:Middlewares/Third_Party/ulibSD/sd_io.c ****             if (__SD_Send_Cmd(CMD8, 0x1AA) == 1) {
 644              		.loc 1 285 0
 645 0082 4FF4D571 		mov	r1, #426
 646 0086 4820     		movs	r0, #72
 647 0088 FFF7FEFF 		bl	__SD_Send_Cmd
 648              	.LVL116:
 649 008c 0128     		cmp	r0, #1
 650 008e 58D0     		beq	.L73
 286:Middlewares/Third_Party/ulibSD/sd_io.c ****                 // Get trailing return value of R7 resp
 287:Middlewares/Third_Party/ulibSD/sd_io.c ****                 for (n = 0; n < 4; n++) ocr[n] = SPI_RW(0xFF);
 288:Middlewares/Third_Party/ulibSD/sd_io.c ****                 // VDD range of 2.7-3.6V is OK?  
 289:Middlewares/Third_Party/ulibSD/sd_io.c ****                 if ((ocr[2] == 0x01)&&(ocr[3] == 0xAA))
 290:Middlewares/Third_Party/ulibSD/sd_io.c ****                 {
 291:Middlewares/Third_Party/ulibSD/sd_io.c ****                     // Wait for leaving idle state (ACMD41 with HCS bit)...
 292:Middlewares/Third_Party/ulibSD/sd_io.c ****                     SPI_Timer_On(1000);
 293:Middlewares/Third_Party/ulibSD/sd_io.c ****                     while ((SPI_Timer_Status()==TRUE)&&(__SD_Send_Cmd(ACMD41, 1UL << 30)));
 294:Middlewares/Third_Party/ulibSD/sd_io.c ****                     SPI_Timer_Off(); 
 295:Middlewares/Third_Party/ulibSD/sd_io.c ****                     // CCS in the OCR?
 296:Middlewares/Third_Party/ulibSD/sd_io.c ****                     if ((SPI_Timer_Status()==TRUE)&&(__SD_Send_Cmd(CMD58, 0) == 0))
 297:Middlewares/Third_Party/ulibSD/sd_io.c ****                     {
 298:Middlewares/Third_Party/ulibSD/sd_io.c ****                         for (n = 0; n < 4; n++) ocr[n] = SPI_RW(0xFF);
 299:Middlewares/Third_Party/ulibSD/sd_io.c ****                         // SD version 2?
 300:Middlewares/Third_Party/ulibSD/sd_io.c ****                         ct = (ocr[0] & 0x40) ? SDCT_SD2 | SDCT_BLOCK : SDCT_SD2;
 301:Middlewares/Third_Party/ulibSD/sd_io.c ****                     }
 302:Middlewares/Third_Party/ulibSD/sd_io.c ****                 }
 303:Middlewares/Third_Party/ulibSD/sd_io.c ****             } else {
 304:Middlewares/Third_Party/ulibSD/sd_io.c ****                 // SD version 1 or MMC?
ARM GAS  /tmp/cctRxqh5.s 			page 18


 305:Middlewares/Third_Party/ulibSD/sd_io.c ****                 if (__SD_Send_Cmd(ACMD41, 0) <= 1)
 651              		.loc 1 305 0
 652 0090 0021     		movs	r1, #0
 653 0092 E920     		movs	r0, #233
 654 0094 FFF7FEFF 		bl	__SD_Send_Cmd
 655              	.LVL117:
 656 0098 0128     		cmp	r0, #1
 657 009a 66D9     		bls	.L74
 306:Middlewares/Third_Party/ulibSD/sd_io.c ****                 {
 307:Middlewares/Third_Party/ulibSD/sd_io.c ****                     // SD version 1
 308:Middlewares/Third_Party/ulibSD/sd_io.c ****                     ct = SDCT_SD1; 
 309:Middlewares/Third_Party/ulibSD/sd_io.c ****                     cmd = ACMD41;
 310:Middlewares/Third_Party/ulibSD/sd_io.c ****                 } else {
 311:Middlewares/Third_Party/ulibSD/sd_io.c ****                     // MMC version 3
 312:Middlewares/Third_Party/ulibSD/sd_io.c ****                     ct = SDCT_MMC; 
 313:Middlewares/Third_Party/ulibSD/sd_io.c ****                     cmd = CMD1;
 658              		.loc 1 313 0
 659 009c 4FF04108 		mov	r8, #65
 660              	.L57:
 661              	.LVL118:
 314:Middlewares/Third_Party/ulibSD/sd_io.c ****                 }
 315:Middlewares/Third_Party/ulibSD/sd_io.c ****                 // Wait for leaving idle state
 316:Middlewares/Third_Party/ulibSD/sd_io.c ****                 SPI_Timer_On(250);
 662              		.loc 1 316 0
 663 00a0 FA20     		movs	r0, #250
 664 00a2 FFF7FEFF 		bl	SPI_Timer_On
 665              	.LVL119:
 666              	.L59:
 317:Middlewares/Third_Party/ulibSD/sd_io.c ****                 while((SPI_Timer_Status()==TRUE)&&(__SD_Send_Cmd(cmd, 0)));
 667              		.loc 1 317 0 discriminator 2
 668 00a6 FFF7FEFF 		bl	SPI_Timer_Status
 669              	.LVL120:
 670 00aa 0128     		cmp	r0, #1
 671 00ac 05D1     		bne	.L58
 672              		.loc 1 317 0 is_stmt 0 discriminator 1
 673 00ae 0021     		movs	r1, #0
 674 00b0 4046     		mov	r0, r8
 675 00b2 FFF7FEFF 		bl	__SD_Send_Cmd
 676              	.LVL121:
 677 00b6 0028     		cmp	r0, #0
 678 00b8 F5D1     		bne	.L59
 679              	.L58:
 318:Middlewares/Third_Party/ulibSD/sd_io.c ****                 SPI_Timer_Off();
 680              		.loc 1 318 0 is_stmt 1
 681 00ba FFF7FEFF 		bl	SPI_Timer_Off
 682              	.LVL122:
 319:Middlewares/Third_Party/ulibSD/sd_io.c ****                 if(SPI_Timer_Status()==FALSE) ct = 0;
 683              		.loc 1 319 0
 684 00be FFF7FEFF 		bl	SPI_Timer_Status
 685              	.LVL123:
 686 00c2 00B9     		cbnz	r0, .L60
 687 00c4 3446     		mov	r4, r6
 688              	.LVL124:
 689              	.L60:
 320:Middlewares/Third_Party/ulibSD/sd_io.c ****                 if(__SD_Send_Cmd(CMD59, 0))   ct = 0;   // Deactivate CRC check (default)
 690              		.loc 1 320 0
 691 00c6 0021     		movs	r1, #0
ARM GAS  /tmp/cctRxqh5.s 			page 19


 692 00c8 7B20     		movs	r0, #123
 693 00ca FFF7FEFF 		bl	__SD_Send_Cmd
 694              	.LVL125:
 695 00ce 00B1     		cbz	r0, .L61
 696 00d0 3446     		mov	r4, r6
 697              	.LVL126:
 698              	.L61:
 321:Middlewares/Third_Party/ulibSD/sd_io.c ****                 if(__SD_Send_Cmd(CMD16, 512)) ct = 0;   // Set R/W block length to 512 bytes
 699              		.loc 1 321 0
 700 00d2 4FF40071 		mov	r1, #512
 701 00d6 5020     		movs	r0, #80
 702 00d8 FFF7FEFF 		bl	__SD_Send_Cmd
 703              	.LVL127:
 704 00dc 0028     		cmp	r0, #0
 705 00de C0D1     		bne	.L49
 706 00e0 2646     		mov	r6, r4
 707 00e2 BEE7     		b	.L49
 708              	.LVL128:
 709              	.L52:
 287:Middlewares/Third_Party/ulibSD/sd_io.c ****                 // VDD range of 2.7-3.6V is OK?  
 710              		.loc 1 287 0 discriminator 3
 711 00e4 FF20     		movs	r0, #255
 712 00e6 FFF7FEFF 		bl	SPI_RW
 713              	.LVL129:
 714 00ea 02AB     		add	r3, sp, #8
 715 00ec 2344     		add	r3, r3, r4
 716 00ee 03F8040C 		strb	r0, [r3, #-4]
 717 00f2 0134     		adds	r4, r4, #1
 718              	.LVL130:
 719 00f4 E4B2     		uxtb	r4, r4
 720              	.LVL131:
 721              	.L50:
 287:Middlewares/Third_Party/ulibSD/sd_io.c ****                 // VDD range of 2.7-3.6V is OK?  
 722              		.loc 1 287 0 is_stmt 0 discriminator 1
 723 00f6 032C     		cmp	r4, #3
 724 00f8 F4D9     		bls	.L52
 289:Middlewares/Third_Party/ulibSD/sd_io.c ****                 {
 725              		.loc 1 289 0 is_stmt 1
 726 00fa 9DF80630 		ldrb	r3, [sp, #6]	@ zero_extendqisi2
 727 00fe 012B     		cmp	r3, #1
 728 0100 AFD1     		bne	.L49
 289:Middlewares/Third_Party/ulibSD/sd_io.c ****                 {
 729              		.loc 1 289 0 is_stmt 0 discriminator 1
 730 0102 9DF80730 		ldrb	r3, [sp, #7]	@ zero_extendqisi2
 731 0106 AA2B     		cmp	r3, #170
 732 0108 ABD1     		bne	.L49
 292:Middlewares/Third_Party/ulibSD/sd_io.c ****                     while ((SPI_Timer_Status()==TRUE)&&(__SD_Send_Cmd(ACMD41, 1UL << 30)));
 733              		.loc 1 292 0 is_stmt 1
 734 010a 4FF47A70 		mov	r0, #1000
 735 010e FFF7FEFF 		bl	SPI_Timer_On
 736              	.LVL132:
 737              	.L54:
 293:Middlewares/Third_Party/ulibSD/sd_io.c ****                     SPI_Timer_Off(); 
 738              		.loc 1 293 0 discriminator 2
 739 0112 FFF7FEFF 		bl	SPI_Timer_Status
 740              	.LVL133:
 741 0116 0128     		cmp	r0, #1
ARM GAS  /tmp/cctRxqh5.s 			page 20


 742 0118 06D1     		bne	.L53
 293:Middlewares/Third_Party/ulibSD/sd_io.c ****                     SPI_Timer_Off(); 
 743              		.loc 1 293 0 is_stmt 0 discriminator 1
 744 011a 4FF08041 		mov	r1, #1073741824
 745 011e E920     		movs	r0, #233
 746 0120 FFF7FEFF 		bl	__SD_Send_Cmd
 747              	.LVL134:
 748 0124 0028     		cmp	r0, #0
 749 0126 F4D1     		bne	.L54
 750              	.L53:
 294:Middlewares/Third_Party/ulibSD/sd_io.c ****                     // CCS in the OCR?
 751              		.loc 1 294 0 is_stmt 1
 752 0128 FFF7FEFF 		bl	SPI_Timer_Off
 753              	.LVL135:
 296:Middlewares/Third_Party/ulibSD/sd_io.c ****                     {
 754              		.loc 1 296 0
 755 012c FFF7FEFF 		bl	SPI_Timer_Status
 756              	.LVL136:
 757 0130 0128     		cmp	r0, #1
 758 0132 96D1     		bne	.L49
 296:Middlewares/Third_Party/ulibSD/sd_io.c ****                     {
 759              		.loc 1 296 0 is_stmt 0 discriminator 1
 760 0134 0021     		movs	r1, #0
 761 0136 7A20     		movs	r0, #122
 762 0138 FFF7FEFF 		bl	__SD_Send_Cmd
 763              	.LVL137:
 764 013c 0446     		mov	r4, r0
 765              	.LVL138:
 766 013e 58B1     		cbz	r0, .L55
 767 0140 8FE7     		b	.L49
 768              	.L73:
 769 0142 3446     		mov	r4, r6
 770 0144 D7E7     		b	.L50
 771              	.LVL139:
 772              	.L56:
 298:Middlewares/Third_Party/ulibSD/sd_io.c ****                         // SD version 2?
 773              		.loc 1 298 0 is_stmt 1 discriminator 3
 774 0146 FF20     		movs	r0, #255
 775 0148 FFF7FEFF 		bl	SPI_RW
 776              	.LVL140:
 777 014c 02AB     		add	r3, sp, #8
 778 014e 2344     		add	r3, r3, r4
 779 0150 03F8040C 		strb	r0, [r3, #-4]
 780 0154 0134     		adds	r4, r4, #1
 781              	.LVL141:
 782 0156 E4B2     		uxtb	r4, r4
 783              	.LVL142:
 784              	.L55:
 298:Middlewares/Third_Party/ulibSD/sd_io.c ****                         // SD version 2?
 785              		.loc 1 298 0 is_stmt 0 discriminator 1
 786 0158 032C     		cmp	r4, #3
 787 015a F4D9     		bls	.L56
 300:Middlewares/Third_Party/ulibSD/sd_io.c ****                     }
 788              		.loc 1 300 0 is_stmt 1
 789 015c 9DF80430 		ldrb	r3, [sp, #4]	@ zero_extendqisi2
 790 0160 13F0400F 		tst	r3, #64
 791 0164 05D0     		beq	.L66
ARM GAS  /tmp/cctRxqh5.s 			page 21


 792 0166 0C26     		movs	r6, #12
 793              	.LVL143:
 794 0168 7BE7     		b	.L49
 795              	.LVL144:
 796              	.L74:
 308:Middlewares/Third_Party/ulibSD/sd_io.c ****                     cmd = ACMD41;
 797              		.loc 1 308 0
 798 016a 0224     		movs	r4, #2
 309:Middlewares/Third_Party/ulibSD/sd_io.c ****                 } else {
 799              		.loc 1 309 0
 800 016c 4FF0E908 		mov	r8, #233
 801 0170 96E7     		b	.L57
 802              	.LVL145:
 803              	.L66:
 300:Middlewares/Third_Party/ulibSD/sd_io.c ****                     }
 804              		.loc 1 300 0
 805 0172 0426     		movs	r6, #4
 806              	.LVL146:
 807 0174 75E7     		b	.L49
 808              	.LVL147:
 809              	.L62:
 322:Middlewares/Third_Party/ulibSD/sd_io.c ****             }
 323:Middlewares/Third_Party/ulibSD/sd_io.c ****         }
 324:Middlewares/Third_Party/ulibSD/sd_io.c ****     }
 325:Middlewares/Third_Party/ulibSD/sd_io.c ****     if(ct) {
 810              		.loc 1 325 0
 811 0176 3EB9     		cbnz	r6, .L75
 812              	.L64:
 326:Middlewares/Third_Party/ulibSD/sd_io.c ****         dev->cardtype = ct;
 327:Middlewares/Third_Party/ulibSD/sd_io.c ****         dev->mount = TRUE;
 328:Middlewares/Third_Party/ulibSD/sd_io.c ****         dev->last_sector = __SD_Sectors(dev) - 1;
 329:Middlewares/Third_Party/ulibSD/sd_io.c **** #ifdef SD_IO_DBG_COUNT
 330:Middlewares/Third_Party/ulibSD/sd_io.c ****         dev->debug.read = 0;
 331:Middlewares/Third_Party/ulibSD/sd_io.c ****         dev->debug.write = 0;
 332:Middlewares/Third_Party/ulibSD/sd_io.c **** #endif
 333:Middlewares/Third_Party/ulibSD/sd_io.c ****         __SD_Speed_Transfer(HIGH); // High speed transfer
 334:Middlewares/Third_Party/ulibSD/sd_io.c ****     }
 335:Middlewares/Third_Party/ulibSD/sd_io.c ****     SPI_Release();
 813              		.loc 1 335 0
 814 0178 FFF7FEFF 		bl	SPI_Release
 815              	.LVL148:
 336:Middlewares/Third_Party/ulibSD/sd_io.c ****     return (ct ? SD_OK : SD_NOINIT);
 337:Middlewares/Third_Party/ulibSD/sd_io.c **** #endif
 338:Middlewares/Third_Party/ulibSD/sd_io.c **** }
 816              		.loc 1 338 0
 817 017c B6FA86F0 		clz	r0, r6
 818 0180 4009     		lsrs	r0, r0, #5
 819 0182 02B0     		add	sp, sp, #8
 820              	.LCFI9:
 821              		.cfi_remember_state
 822              		.cfi_def_cfa_offset 24
 823              		@ sp needed
 824 0184 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 825              	.LVL149:
 826              	.L75:
 827              	.LCFI10:
 828              		.cfi_restore_state
ARM GAS  /tmp/cctRxqh5.s 			page 22


 326:Middlewares/Third_Party/ulibSD/sd_io.c ****         dev->cardtype = ct;
 829              		.loc 1 326 0
 830 0188 7E70     		strb	r6, [r7, #1]
 327:Middlewares/Third_Party/ulibSD/sd_io.c ****         dev->last_sector = __SD_Sectors(dev) - 1;
 831              		.loc 1 327 0
 832 018a 0124     		movs	r4, #1
 833 018c 3C70     		strb	r4, [r7]
 328:Middlewares/Third_Party/ulibSD/sd_io.c **** #ifdef SD_IO_DBG_COUNT
 834              		.loc 1 328 0
 835 018e 3846     		mov	r0, r7
 836 0190 FFF7FEFF 		bl	__SD_Sectors
 837              	.LVL150:
 838 0194 0138     		subs	r0, r0, #1
 839 0196 7860     		str	r0, [r7, #4]
 333:Middlewares/Third_Party/ulibSD/sd_io.c ****     }
 840              		.loc 1 333 0
 841 0198 2046     		mov	r0, r4
 842 019a FFF7FEFF 		bl	__SD_Speed_Transfer
 843              	.LVL151:
 844 019e EBE7     		b	.L64
 845              		.cfi_endproc
 846              	.LFE7:
 848              		.section	.text.SD_Read,"ax",%progbits
 849              		.align	1
 850              		.global	SD_Read
 851              		.syntax unified
 852              		.thumb
 853              		.thumb_func
 854              		.fpu softvfp
 856              	SD_Read:
 857              	.LFB8:
 339:Middlewares/Third_Party/ulibSD/sd_io.c **** 
 340:Middlewares/Third_Party/ulibSD/sd_io.c **** SDRESULTS SD_Read(SD_DEV *dev, void *dat, DWORD sector, WORD ofs, WORD cnt)
 341:Middlewares/Third_Party/ulibSD/sd_io.c **** {
 858              		.loc 1 341 0
 859              		.cfi_startproc
 860              		@ args = 4, pretend = 0, frame = 0
 861              		@ frame_needed = 0, uses_anonymous_args = 0
 862              	.LVL152:
 863 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 864              	.LCFI11:
 865              		.cfi_def_cfa_offset 24
 866              		.cfi_offset 3, -24
 867              		.cfi_offset 4, -20
 868              		.cfi_offset 5, -16
 869              		.cfi_offset 6, -12
 870              		.cfi_offset 7, -8
 871              		.cfi_offset 14, -4
 872 0002 1D46     		mov	r5, r3
 873 0004 BDF81840 		ldrh	r4, [sp, #24]
 874              	.LVL153:
 342:Middlewares/Third_Party/ulibSD/sd_io.c **** #if defined(_M_IX86)    // x86
 343:Middlewares/Third_Party/ulibSD/sd_io.c ****     // Check the sector query
 344:Middlewares/Third_Party/ulibSD/sd_io.c ****     if((sector > dev->last_sector)||(cnt == 0)) return(SD_PARERR);
 345:Middlewares/Third_Party/ulibSD/sd_io.c ****     if(dev->fp!=NULL)
 346:Middlewares/Third_Party/ulibSD/sd_io.c ****     {
 347:Middlewares/Third_Party/ulibSD/sd_io.c ****         if (fseek(dev->fp, ((512 * sector) + ofs), SEEK_SET)!=0)
ARM GAS  /tmp/cctRxqh5.s 			page 23


 348:Middlewares/Third_Party/ulibSD/sd_io.c ****             return(SD_ERROR);
 349:Middlewares/Third_Party/ulibSD/sd_io.c ****         else {
 350:Middlewares/Third_Party/ulibSD/sd_io.c ****             if(fread(dat, 1, (cnt - ofs),dev->fp)==(cnt - ofs))
 351:Middlewares/Third_Party/ulibSD/sd_io.c ****             {
 352:Middlewares/Third_Party/ulibSD/sd_io.c **** #ifdef SD_IO_DBG_COUNT
 353:Middlewares/Third_Party/ulibSD/sd_io.c ****                 dev->debug.read++;
 354:Middlewares/Third_Party/ulibSD/sd_io.c **** #endif
 355:Middlewares/Third_Party/ulibSD/sd_io.c ****                 return(SD_OK);
 356:Middlewares/Third_Party/ulibSD/sd_io.c ****             }
 357:Middlewares/Third_Party/ulibSD/sd_io.c ****             else return(SD_ERROR);
 358:Middlewares/Third_Party/ulibSD/sd_io.c ****         }
 359:Middlewares/Third_Party/ulibSD/sd_io.c ****     } else {
 360:Middlewares/Third_Party/ulibSD/sd_io.c ****         return(SD_ERROR);
 361:Middlewares/Third_Party/ulibSD/sd_io.c ****     }
 362:Middlewares/Third_Party/ulibSD/sd_io.c **** #else   // uControllers
 363:Middlewares/Third_Party/ulibSD/sd_io.c ****     SDRESULTS res;
 364:Middlewares/Third_Party/ulibSD/sd_io.c ****     BYTE tkn;
 365:Middlewares/Third_Party/ulibSD/sd_io.c ****     WORD remaining;
 366:Middlewares/Third_Party/ulibSD/sd_io.c ****     res = SD_ERROR;
 367:Middlewares/Third_Party/ulibSD/sd_io.c ****     if ((sector > dev->last_sector)||(cnt == 0)) return(SD_PARERR);
 875              		.loc 1 367 0
 876 0008 4368     		ldr	r3, [r0, #4]
 877              	.LVL154:
 878 000a 9342     		cmp	r3, r2
 879 000c 02D2     		bcs	.L90
 880 000e 0324     		movs	r4, #3
 881              	.LVL155:
 882              	.L77:
 368:Middlewares/Third_Party/ulibSD/sd_io.c ****     // Convert sector number to byte address (sector * SD_BLK_SIZE)
 369:Middlewares/Third_Party/ulibSD/sd_io.c ****     if (__SD_Send_Cmd(CMD17, sector * SD_BLK_SIZE) == 0) {
 370:Middlewares/Third_Party/ulibSD/sd_io.c ****         SPI_Timer_On(100);  // Wait for data packet (timeout of 100ms)
 371:Middlewares/Third_Party/ulibSD/sd_io.c ****         do {
 372:Middlewares/Third_Party/ulibSD/sd_io.c ****             tkn = SPI_RW(0xFF);
 373:Middlewares/Third_Party/ulibSD/sd_io.c ****         } while((tkn==0xFF)&&(SPI_Timer_Status()==TRUE));
 374:Middlewares/Third_Party/ulibSD/sd_io.c ****         SPI_Timer_Off();
 375:Middlewares/Third_Party/ulibSD/sd_io.c ****         // Token of single block?
 376:Middlewares/Third_Party/ulibSD/sd_io.c ****         if(tkn==0xFE) { 
 377:Middlewares/Third_Party/ulibSD/sd_io.c ****             // Size block (512 bytes) + CRC (2 bytes) - offset - bytes to count
 378:Middlewares/Third_Party/ulibSD/sd_io.c ****             remaining = SD_BLK_SIZE + 2 - ofs - cnt;
 379:Middlewares/Third_Party/ulibSD/sd_io.c ****             // Skip offset
 380:Middlewares/Third_Party/ulibSD/sd_io.c ****             if(ofs) { 
 381:Middlewares/Third_Party/ulibSD/sd_io.c ****                 do { 
 382:Middlewares/Third_Party/ulibSD/sd_io.c ****                     SPI_RW(0xFF); 
 383:Middlewares/Third_Party/ulibSD/sd_io.c ****                 } while(--ofs);
 384:Middlewares/Third_Party/ulibSD/sd_io.c ****             }
 385:Middlewares/Third_Party/ulibSD/sd_io.c ****             // I receive the data and I write in user's buffer
 386:Middlewares/Third_Party/ulibSD/sd_io.c ****             do {
 387:Middlewares/Third_Party/ulibSD/sd_io.c ****                 *(BYTE*)dat = SPI_RW(0xFF);
 388:Middlewares/Third_Party/ulibSD/sd_io.c ****                 dat++;
 389:Middlewares/Third_Party/ulibSD/sd_io.c ****             } while(--cnt);
 390:Middlewares/Third_Party/ulibSD/sd_io.c ****             // Skip remaining
 391:Middlewares/Third_Party/ulibSD/sd_io.c ****             do { 
 392:Middlewares/Third_Party/ulibSD/sd_io.c ****                 SPI_RW(0xFF); 
 393:Middlewares/Third_Party/ulibSD/sd_io.c ****             } while (--remaining);
 394:Middlewares/Third_Party/ulibSD/sd_io.c ****             res = SD_OK;
 395:Middlewares/Third_Party/ulibSD/sd_io.c ****         }
 396:Middlewares/Third_Party/ulibSD/sd_io.c ****     }
ARM GAS  /tmp/cctRxqh5.s 			page 24


 397:Middlewares/Third_Party/ulibSD/sd_io.c ****     SPI_Release();
 398:Middlewares/Third_Party/ulibSD/sd_io.c **** #ifdef SD_IO_DBG_COUNT
 399:Middlewares/Third_Party/ulibSD/sd_io.c ****     dev->debug.read++;
 400:Middlewares/Third_Party/ulibSD/sd_io.c **** #endif
 401:Middlewares/Third_Party/ulibSD/sd_io.c ****     return(res);
 402:Middlewares/Third_Party/ulibSD/sd_io.c **** #endif
 403:Middlewares/Third_Party/ulibSD/sd_io.c **** }
 883              		.loc 1 403 0
 884 0010 2046     		mov	r0, r4
 885 0012 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 886              	.LVL156:
 887              	.L90:
 888 0014 0E46     		mov	r6, r1
 367:Middlewares/Third_Party/ulibSD/sd_io.c ****     // Convert sector number to byte address (sector * SD_BLK_SIZE)
 889              		.loc 1 367 0 discriminator 2
 890 0016 0CB9     		cbnz	r4, .L91
 367:Middlewares/Third_Party/ulibSD/sd_io.c ****     // Convert sector number to byte address (sector * SD_BLK_SIZE)
 891              		.loc 1 367 0 is_stmt 0
 892 0018 0324     		movs	r4, #3
 893 001a F9E7     		b	.L77
 894              	.L91:
 369:Middlewares/Third_Party/ulibSD/sd_io.c ****         SPI_Timer_On(100);  // Wait for data packet (timeout of 100ms)
 895              		.loc 1 369 0 is_stmt 1
 896 001c 5102     		lsls	r1, r2, #9
 897              	.LVL157:
 898 001e 5120     		movs	r0, #81
 899              	.LVL158:
 900 0020 FFF7FEFF 		bl	__SD_Send_Cmd
 901              	.LVL159:
 902 0024 18B1     		cbz	r0, .L92
 366:Middlewares/Third_Party/ulibSD/sd_io.c ****     if ((sector > dev->last_sector)||(cnt == 0)) return(SD_PARERR);
 903              		.loc 1 366 0
 904 0026 0224     		movs	r4, #2
 905              	.LVL160:
 906              	.L78:
 397:Middlewares/Third_Party/ulibSD/sd_io.c **** #ifdef SD_IO_DBG_COUNT
 907              		.loc 1 397 0
 908 0028 FFF7FEFF 		bl	SPI_Release
 909              	.LVL161:
 401:Middlewares/Third_Party/ulibSD/sd_io.c **** #endif
 910              		.loc 1 401 0
 911 002c F0E7     		b	.L77
 912              	.LVL162:
 913              	.L92:
 370:Middlewares/Third_Party/ulibSD/sd_io.c ****         do {
 914              		.loc 1 370 0
 915 002e 6420     		movs	r0, #100
 916 0030 FFF7FEFF 		bl	SPI_Timer_On
 917              	.LVL163:
 918              	.L80:
 372:Middlewares/Third_Party/ulibSD/sd_io.c ****         } while((tkn==0xFF)&&(SPI_Timer_Status()==TRUE));
 919              		.loc 1 372 0 discriminator 2
 920 0034 FF20     		movs	r0, #255
 921 0036 FFF7FEFF 		bl	SPI_RW
 922              	.LVL164:
 923 003a 0746     		mov	r7, r0
 924              	.LVL165:
ARM GAS  /tmp/cctRxqh5.s 			page 25


 373:Middlewares/Third_Party/ulibSD/sd_io.c ****         SPI_Timer_Off();
 925              		.loc 1 373 0 discriminator 2
 926 003c FF28     		cmp	r0, #255
 927 003e 03D1     		bne	.L79
 373:Middlewares/Third_Party/ulibSD/sd_io.c ****         SPI_Timer_Off();
 928              		.loc 1 373 0 is_stmt 0 discriminator 1
 929 0040 FFF7FEFF 		bl	SPI_Timer_Status
 930              	.LVL166:
 931 0044 0128     		cmp	r0, #1
 932 0046 F5D0     		beq	.L80
 933              	.L79:
 374:Middlewares/Third_Party/ulibSD/sd_io.c ****         // Token of single block?
 934              		.loc 1 374 0 is_stmt 1
 935 0048 FFF7FEFF 		bl	SPI_Timer_Off
 936              	.LVL167:
 376:Middlewares/Third_Party/ulibSD/sd_io.c ****             // Size block (512 bytes) + CRC (2 bytes) - offset - bytes to count
 937              		.loc 1 376 0
 938 004c FE2F     		cmp	r7, #254
 939 004e 01D0     		beq	.L93
 366:Middlewares/Third_Party/ulibSD/sd_io.c ****     if ((sector > dev->last_sector)||(cnt == 0)) return(SD_PARERR);
 940              		.loc 1 366 0
 941 0050 0224     		movs	r4, #2
 942 0052 E9E7     		b	.L78
 943              	.L93:
 378:Middlewares/Third_Party/ulibSD/sd_io.c ****             // Skip offset
 944              		.loc 1 378 0
 945 0054 6F42     		negs	r7, r5
 946 0056 3F1B     		subs	r7, r7, r4
 947 0058 BFB2     		uxth	r7, r7
 948 005a 07F20227 		addw	r7, r7, #514
 949 005e BFB2     		uxth	r7, r7
 950              	.LVL168:
 380:Middlewares/Third_Party/ulibSD/sd_io.c ****                 do { 
 951              		.loc 1 380 0
 952 0060 35B1     		cbz	r5, .L83
 953              	.LVL169:
 954              	.L82:
 382:Middlewares/Third_Party/ulibSD/sd_io.c ****                 } while(--ofs);
 955              		.loc 1 382 0 discriminator 1
 956 0062 FF20     		movs	r0, #255
 957 0064 FFF7FEFF 		bl	SPI_RW
 958              	.LVL170:
 383:Middlewares/Third_Party/ulibSD/sd_io.c ****             }
 959              		.loc 1 383 0 discriminator 1
 960 0068 013D     		subs	r5, r5, #1
 961              	.LVL171:
 962 006a ADB2     		uxth	r5, r5
 963              	.LVL172:
 964 006c 002D     		cmp	r5, #0
 965 006e F8D1     		bne	.L82
 966              	.LVL173:
 967              	.L83:
 387:Middlewares/Third_Party/ulibSD/sd_io.c ****                 dat++;
 968              		.loc 1 387 0 discriminator 1
 969 0070 FF20     		movs	r0, #255
 970 0072 FFF7FEFF 		bl	SPI_RW
 971              	.LVL174:
ARM GAS  /tmp/cctRxqh5.s 			page 26


 972 0076 06F8010B 		strb	r0, [r6], #1
 973              	.LVL175:
 389:Middlewares/Third_Party/ulibSD/sd_io.c ****             // Skip remaining
 974              		.loc 1 389 0 discriminator 1
 975 007a 013C     		subs	r4, r4, #1
 976              	.LVL176:
 977 007c A4B2     		uxth	r4, r4
 978              	.LVL177:
 979 007e 002C     		cmp	r4, #0
 980 0080 F6D1     		bne	.L83
 981              	.L84:
 392:Middlewares/Third_Party/ulibSD/sd_io.c ****             } while (--remaining);
 982              		.loc 1 392 0 discriminator 1
 983 0082 FF20     		movs	r0, #255
 984 0084 FFF7FEFF 		bl	SPI_RW
 985              	.LVL178:
 393:Middlewares/Third_Party/ulibSD/sd_io.c ****             res = SD_OK;
 986              		.loc 1 393 0 discriminator 1
 987 0088 013F     		subs	r7, r7, #1
 988              	.LVL179:
 989 008a BFB2     		uxth	r7, r7
 990              	.LVL180:
 991 008c 002F     		cmp	r7, #0
 992 008e F8D1     		bne	.L84
 394:Middlewares/Third_Party/ulibSD/sd_io.c ****         }
 993              		.loc 1 394 0
 994 0090 0024     		movs	r4, #0
 995              	.LVL181:
 996 0092 C9E7     		b	.L78
 997              		.cfi_endproc
 998              	.LFE8:
 1000              		.section	.text.SD_Write,"ax",%progbits
 1001              		.align	1
 1002              		.global	SD_Write
 1003              		.syntax unified
 1004              		.thumb
 1005              		.thumb_func
 1006              		.fpu softvfp
 1008              	SD_Write:
 1009              	.LFB9:
 404:Middlewares/Third_Party/ulibSD/sd_io.c **** 
 405:Middlewares/Third_Party/ulibSD/sd_io.c **** #ifdef SD_IO_WRITE
 406:Middlewares/Third_Party/ulibSD/sd_io.c **** SDRESULTS SD_Write(SD_DEV *dev, void *dat, DWORD sector)
 407:Middlewares/Third_Party/ulibSD/sd_io.c **** {
 1010              		.loc 1 407 0
 1011              		.cfi_startproc
 1012              		@ args = 0, pretend = 0, frame = 0
 1013              		@ frame_needed = 0, uses_anonymous_args = 0
 1014              	.LVL182:
 1015 0000 38B5     		push	{r3, r4, r5, lr}
 1016              	.LCFI12:
 1017              		.cfi_def_cfa_offset 16
 1018              		.cfi_offset 3, -16
 1019              		.cfi_offset 4, -12
 1020              		.cfi_offset 5, -8
 1021              		.cfi_offset 14, -4
 408:Middlewares/Third_Party/ulibSD/sd_io.c **** #if defined(_M_IX86)    // x86
ARM GAS  /tmp/cctRxqh5.s 			page 27


 409:Middlewares/Third_Party/ulibSD/sd_io.c ****     // Query ok?
 410:Middlewares/Third_Party/ulibSD/sd_io.c ****     if(sector > dev->last_sector) return(SD_PARERR);
 411:Middlewares/Third_Party/ulibSD/sd_io.c ****     if(dev->fp != NULL)
 412:Middlewares/Third_Party/ulibSD/sd_io.c ****     {
 413:Middlewares/Third_Party/ulibSD/sd_io.c ****         if(fseek(dev->fp, SD_BLK_SIZE * sector, SEEK_SET)!=0)
 414:Middlewares/Third_Party/ulibSD/sd_io.c ****             return(SD_ERROR);
 415:Middlewares/Third_Party/ulibSD/sd_io.c ****         else {
 416:Middlewares/Third_Party/ulibSD/sd_io.c ****             if(fwrite(dat, 1, SD_BLK_SIZE, dev->fp)==SD_BLK_SIZE)
 417:Middlewares/Third_Party/ulibSD/sd_io.c ****             {
 418:Middlewares/Third_Party/ulibSD/sd_io.c **** #ifdef SD_IO_DBG_COUNT
 419:Middlewares/Third_Party/ulibSD/sd_io.c ****                 dev->debug.write++;
 420:Middlewares/Third_Party/ulibSD/sd_io.c **** #endif
 421:Middlewares/Third_Party/ulibSD/sd_io.c ****                 return(SD_OK);
 422:Middlewares/Third_Party/ulibSD/sd_io.c ****             }
 423:Middlewares/Third_Party/ulibSD/sd_io.c ****             else return(SD_ERROR);
 424:Middlewares/Third_Party/ulibSD/sd_io.c ****         }
 425:Middlewares/Third_Party/ulibSD/sd_io.c ****     } else return(SD_ERROR);
 426:Middlewares/Third_Party/ulibSD/sd_io.c **** #else   // uControllers
 427:Middlewares/Third_Party/ulibSD/sd_io.c ****     // Query ok?
 428:Middlewares/Third_Party/ulibSD/sd_io.c ****     if(sector > dev->last_sector) return(SD_PARERR);
 1022              		.loc 1 428 0
 1023 0002 4368     		ldr	r3, [r0, #4]
 1024 0004 9342     		cmp	r3, r2
 1025 0006 01D2     		bcs	.L99
 1026 0008 0320     		movs	r0, #3
 1027              	.LVL183:
 1028 000a 38BD     		pop	{r3, r4, r5, pc}
 1029              	.LVL184:
 1030              	.L99:
 1031 000c 0D46     		mov	r5, r1
 1032 000e 0446     		mov	r4, r0
 429:Middlewares/Third_Party/ulibSD/sd_io.c ****     // Single block write (token <- 0xFE)
 430:Middlewares/Third_Party/ulibSD/sd_io.c ****     // Convert sector number to bytes address (sector * SD_BLK_SIZE)
 431:Middlewares/Third_Party/ulibSD/sd_io.c ****     if(__SD_Send_Cmd(CMD24, sector * SD_BLK_SIZE)==0)
 1033              		.loc 1 431 0
 1034 0010 5102     		lsls	r1, r2, #9
 1035              	.LVL185:
 1036 0012 5820     		movs	r0, #88
 1037              	.LVL186:
 1038 0014 FFF7FEFF 		bl	__SD_Send_Cmd
 1039              	.LVL187:
 1040 0018 08B1     		cbz	r0, .L100
 432:Middlewares/Third_Party/ulibSD/sd_io.c ****         return(__SD_Write_Block(dev, dat, 0xFE));
 433:Middlewares/Third_Party/ulibSD/sd_io.c ****     else
 434:Middlewares/Third_Party/ulibSD/sd_io.c ****         return(SD_ERROR);
 1041              		.loc 1 434 0
 1042 001a 0220     		movs	r0, #2
 435:Middlewares/Third_Party/ulibSD/sd_io.c **** #endif
 436:Middlewares/Third_Party/ulibSD/sd_io.c **** }
 1043              		.loc 1 436 0
 1044 001c 38BD     		pop	{r3, r4, r5, pc}
 1045              	.LVL188:
 1046              	.L100:
 432:Middlewares/Third_Party/ulibSD/sd_io.c ****         return(__SD_Write_Block(dev, dat, 0xFE));
 1047              		.loc 1 432 0
 1048 001e FE22     		movs	r2, #254
 1049 0020 2946     		mov	r1, r5
ARM GAS  /tmp/cctRxqh5.s 			page 28


 1050 0022 2046     		mov	r0, r4
 1051 0024 FFF7FEFF 		bl	__SD_Write_Block
 1052              	.LVL189:
 1053 0028 38BD     		pop	{r3, r4, r5, pc}
 1054              		.cfi_endproc
 1055              	.LFE9:
 1057              		.section	.text.SD_Status,"ax",%progbits
 1058              		.align	1
 1059              		.global	SD_Status
 1060              		.syntax unified
 1061              		.thumb
 1062              		.thumb_func
 1063              		.fpu softvfp
 1065              	SD_Status:
 1066              	.LFB10:
 437:Middlewares/Third_Party/ulibSD/sd_io.c **** #endif
 438:Middlewares/Third_Party/ulibSD/sd_io.c **** 
 439:Middlewares/Third_Party/ulibSD/sd_io.c **** SDRESULTS SD_Status(SD_DEV *dev)
 440:Middlewares/Third_Party/ulibSD/sd_io.c **** {
 1067              		.loc 1 440 0
 1068              		.cfi_startproc
 1069              		@ args = 0, pretend = 0, frame = 0
 1070              		@ frame_needed = 0, uses_anonymous_args = 0
 1071              	.LVL190:
 1072 0000 08B5     		push	{r3, lr}
 1073              	.LCFI13:
 1074              		.cfi_def_cfa_offset 8
 1075              		.cfi_offset 3, -8
 1076              		.cfi_offset 14, -4
 441:Middlewares/Third_Party/ulibSD/sd_io.c **** #if defined(_M_IX86)
 442:Middlewares/Third_Party/ulibSD/sd_io.c ****     return((dev->fp == NULL) ? SD_OK : SD_NORESPONSE);
 443:Middlewares/Third_Party/ulibSD/sd_io.c **** #else
 444:Middlewares/Third_Party/ulibSD/sd_io.c ****     return(__SD_Send_Cmd(CMD0, 0) ? SD_OK : SD_NORESPONSE);
 1077              		.loc 1 444 0
 1078 0002 0021     		movs	r1, #0
 1079 0004 4020     		movs	r0, #64
 1080              	.LVL191:
 1081 0006 FFF7FEFF 		bl	__SD_Send_Cmd
 1082              	.LVL192:
 1083 000a 08B9     		cbnz	r0, .L105
 1084 000c 0620     		movs	r0, #6
 445:Middlewares/Third_Party/ulibSD/sd_io.c **** #endif
 446:Middlewares/Third_Party/ulibSD/sd_io.c **** }
 1085              		.loc 1 446 0
 1086 000e 08BD     		pop	{r3, pc}
 1087              	.L105:
 444:Middlewares/Third_Party/ulibSD/sd_io.c **** #endif
 1088              		.loc 1 444 0
 1089 0010 0020     		movs	r0, #0
 1090 0012 08BD     		pop	{r3, pc}
 1091              		.cfi_endproc
 1092              	.LFE10:
 1094              		.text
 1095              	.Letext0:
 1096              		.file 2 "Middlewares/Third_Party/FatFs/src/integer.h"
 1097              		.file 3 "/usr/include/newlib/machine/_default_types.h"
 1098              		.file 4 "/usr/include/newlib/sys/_stdint.h"
ARM GAS  /tmp/cctRxqh5.s 			page 29


 1099              		.file 5 "Middlewares/Third_Party/ulibSD/integer_ulibsd.h"
 1100              		.file 6 "Middlewares/Third_Party/ulibSD/sd_io.h"
 1101              		.file 7 "Middlewares/Third_Party/ulibSD/spi_io.h"
ARM GAS  /tmp/cctRxqh5.s 			page 30


DEFINED SYMBOLS
                            *ABS*:0000000000000000 sd_io.c
     /tmp/cctRxqh5.s:16     .text.__SD_Power_Of_Two:0000000000000000 $t
     /tmp/cctRxqh5.s:23     .text.__SD_Power_Of_Two:0000000000000000 __SD_Power_Of_Two
     /tmp/cctRxqh5.s:59     .text.__SD_Speed_Transfer:0000000000000000 $t
     /tmp/cctRxqh5.s:66     .text.__SD_Speed_Transfer:0000000000000000 __SD_Speed_Transfer
     /tmp/cctRxqh5.s:95     .text.__SD_Send_Cmd:0000000000000000 $t
     /tmp/cctRxqh5.s:102    .text.__SD_Send_Cmd:0000000000000000 __SD_Send_Cmd
     /tmp/cctRxqh5.s:239    .text.__SD_Write_Block:0000000000000000 $t
     /tmp/cctRxqh5.s:246    .text.__SD_Write_Block:0000000000000000 __SD_Write_Block
     /tmp/cctRxqh5.s:340    .text.__SD_Sectors:0000000000000000 $t
     /tmp/cctRxqh5.s:347    .text.__SD_Sectors:0000000000000000 __SD_Sectors
     /tmp/cctRxqh5.s:522    .text.SD_Init:0000000000000000 $t
     /tmp/cctRxqh5.s:529    .text.SD_Init:0000000000000000 SD_Init
     /tmp/cctRxqh5.s:849    .text.SD_Read:0000000000000000 $t
     /tmp/cctRxqh5.s:856    .text.SD_Read:0000000000000000 SD_Read
     /tmp/cctRxqh5.s:1001   .text.SD_Write:0000000000000000 $t
     /tmp/cctRxqh5.s:1008   .text.SD_Write:0000000000000000 SD_Write
     /tmp/cctRxqh5.s:1058   .text.SD_Status:0000000000000000 $t
     /tmp/cctRxqh5.s:1065   .text.SD_Status:0000000000000000 SD_Status
                     .debug_frame:0000000000000010 $d

UNDEFINED SYMBOLS
SPI_Freq_Low
SPI_Freq_High
SPI_CS_High
SPI_RW
SPI_CS_Low
SPI_Timer_On
SPI_Timer_Status
SPI_Timer_Off
SPI_Release
SPI_Init
