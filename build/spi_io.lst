ARM GAS  /tmp/cc1Sd0xR.s 			page 1


   1              		.cpu cortex-m3
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 1
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 4
  11              		.file	"spi_io.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.text.SPI_Init,"ax",%progbits
  16              		.align	1
  17              		.global	SPI_Init
  18              		.syntax unified
  19              		.thumb
  20              		.thumb_func
  21              		.fpu softvfp
  23              	SPI_Init:
  24              	.LFB66:
  25              		.file 1 "Middlewares/Third_Party/ulibSD/spi_io.c"
   1:Middlewares/Third_Party/ulibSD/spi_io.c **** /*
   2:Middlewares/Third_Party/ulibSD/spi_io.c ****  *  File: spi_io.c.example
   3:Middlewares/Third_Party/ulibSD/spi_io.c ****  *  Author: Nelson Lombardo
   4:Middlewares/Third_Party/ulibSD/spi_io.c ****  *  Year: 2015
   5:Middlewares/Third_Party/ulibSD/spi_io.c ****  *  e-mail: nelson.lombardo@gmail.com
   6:Middlewares/Third_Party/ulibSD/spi_io.c ****  *  License at the end of file.
   7:Middlewares/Third_Party/ulibSD/spi_io.c ****  */
   8:Middlewares/Third_Party/ulibSD/spi_io.c **** 
   9:Middlewares/Third_Party/ulibSD/spi_io.c **** #include <stdio.h>
  10:Middlewares/Third_Party/ulibSD/spi_io.c **** #include "spi_io.h"
  11:Middlewares/Third_Party/ulibSD/spi_io.c **** #include "main.h"
  12:Middlewares/Third_Party/ulibSD/spi_io.c **** 
  13:Middlewares/Third_Party/ulibSD/spi_io.c **** extern SPI_HandleTypeDef hspi1;
  14:Middlewares/Third_Party/ulibSD/spi_io.c **** /*
  15:Middlewares/Third_Party/ulibSD/spi_io.c **** extern TIM_HandleTypeDef htim1;
  16:Middlewares/Third_Party/ulibSD/spi_io.c **** uint32_t * GPIOA_BSRR = (uint32_t *)0x40010810;
  17:Middlewares/Third_Party/ulibSD/spi_io.c **** uint32_t * GPIOA_BRR = (uint32_t *)0x40010814;
  18:Middlewares/Third_Party/ulibSD/spi_io.c **** uint16_t SPI_NSS_Pin_Pos = 4u;
  19:Middlewares/Third_Party/ulibSD/spi_io.c **** uint32_t SPI_NSS_Pin_Mask = (0x1 << 4);
  20:Middlewares/Third_Party/ulibSD/spi_io.c **** uint32_t * RCC_CFGR = (uint32_t *)0x40021004;
  21:Middlewares/Third_Party/ulibSD/spi_io.c **** uint16_t PPRE2_Pos = 11u;
  22:Middlewares/Third_Party/ulibSD/spi_io.c **** uint32_t PPRE2_Mask = (0x111 << 11);
  23:Middlewares/Third_Party/ulibSD/spi_io.c **** uint32_t * SPI_CR1 = (uint32_t *)0x40013000;
  24:Middlewares/Third_Party/ulibSD/spi_io.c **** uint16_t SPI_BR_Pos = 3u;
  25:Middlewares/Third_Party/ulibSD/spi_io.c **** uint32_t SPI_BR_Mask = (0x111 << 3);
  26:Middlewares/Third_Party/ulibSD/spi_io.c **** */
  27:Middlewares/Third_Party/ulibSD/spi_io.c **** 
  28:Middlewares/Third_Party/ulibSD/spi_io.c **** uint32_t spiTimerTickStart;
  29:Middlewares/Third_Party/ulibSD/spi_io.c **** uint32_t spiTimerTickDelay;
  30:Middlewares/Third_Party/ulibSD/spi_io.c **** 
  31:Middlewares/Third_Party/ulibSD/spi_io.c **** 
  32:Middlewares/Third_Party/ulibSD/spi_io.c **** /******************************************************************************
  33:Middlewares/Third_Party/ulibSD/spi_io.c ****  Module Public Functions - Low level SPI control functions
ARM GAS  /tmp/cc1Sd0xR.s 			page 2


  34:Middlewares/Third_Party/ulibSD/spi_io.c **** ******************************************************************************/
  35:Middlewares/Third_Party/ulibSD/spi_io.c **** 
  36:Middlewares/Third_Party/ulibSD/spi_io.c **** void SPI_Init (void) {
  26              		.loc 1 36 0
  27              		.cfi_startproc
  28              		@ args = 0, pretend = 0, frame = 0
  29              		@ frame_needed = 0, uses_anonymous_args = 0
  30              		@ link register save eliminated.
  31 0000 7047     		bx	lr
  32              		.cfi_endproc
  33              	.LFE66:
  35              		.section	.text.SPI_RW,"ax",%progbits
  36              		.align	1
  37              		.global	SPI_RW
  38              		.syntax unified
  39              		.thumb
  40              		.thumb_func
  41              		.fpu softvfp
  43              	SPI_RW:
  44              	.LFB67:
  37:Middlewares/Third_Party/ulibSD/spi_io.c **** }
  38:Middlewares/Third_Party/ulibSD/spi_io.c **** 
  39:Middlewares/Third_Party/ulibSD/spi_io.c **** BYTE SPI_RW (BYTE d) {
  45              		.loc 1 39 0
  46              		.cfi_startproc
  47              		@ args = 0, pretend = 0, frame = 8
  48              		@ frame_needed = 0, uses_anonymous_args = 0
  49              	.LVL0:
  50              		.loc 1 39 0
  51 0000 00B5     		push	{lr}
  52              	.LCFI0:
  53              		.cfi_def_cfa_offset 4
  54              		.cfi_offset 14, -4
  55 0002 85B0     		sub	sp, sp, #20
  56              	.LCFI1:
  57              		.cfi_def_cfa_offset 24
  40:Middlewares/Third_Party/ulibSD/spi_io.c ****     uint8_t rx_data = 0, tx_data = d;
  58              		.loc 1 40 0
  59 0004 0023     		movs	r3, #0
  60 0006 8DF80F30 		strb	r3, [sp, #15]
  61 000a 8DF80E00 		strb	r0, [sp, #14]
  41:Middlewares/Third_Party/ulibSD/spi_io.c ****     HAL_SPI_TransmitReceive(&hspi1, (uint8_t *)(&tx_data), &rx_data, 1, 0);
  62              		.loc 1 41 0
  63 000e 0093     		str	r3, [sp]
  64 0010 0123     		movs	r3, #1
  65 0012 0DF10F02 		add	r2, sp, #15
  66 0016 0DF10E01 		add	r1, sp, #14
  67 001a 0448     		ldr	r0, .L4
  68              	.LVL1:
  69 001c FFF7FEFF 		bl	HAL_SPI_TransmitReceive
  70              	.LVL2:
  42:Middlewares/Third_Party/ulibSD/spi_io.c ****     return (rx_data);
  43:Middlewares/Third_Party/ulibSD/spi_io.c **** }
  71              		.loc 1 43 0
  72 0020 9DF80F00 		ldrb	r0, [sp, #15]	@ zero_extendqisi2
  73 0024 05B0     		add	sp, sp, #20
  74              	.LCFI2:
ARM GAS  /tmp/cc1Sd0xR.s 			page 3


  75              		.cfi_def_cfa_offset 4
  76              		@ sp needed
  77 0026 5DF804FB 		ldr	pc, [sp], #4
  78              	.L5:
  79 002a 00BF     		.align	2
  80              	.L4:
  81 002c 00000000 		.word	hspi1
  82              		.cfi_endproc
  83              	.LFE67:
  85              		.section	.text.SPI_Release,"ax",%progbits
  86              		.align	1
  87              		.global	SPI_Release
  88              		.syntax unified
  89              		.thumb
  90              		.thumb_func
  91              		.fpu softvfp
  93              	SPI_Release:
  94              	.LFB68:
  44:Middlewares/Third_Party/ulibSD/spi_io.c **** 
  45:Middlewares/Third_Party/ulibSD/spi_io.c **** void SPI_Release (void) {
  95              		.loc 1 45 0
  96              		.cfi_startproc
  97              		@ args = 0, pretend = 0, frame = 0
  98              		@ frame_needed = 0, uses_anonymous_args = 0
  99 0000 10B5     		push	{r4, lr}
 100              	.LCFI3:
 101              		.cfi_def_cfa_offset 8
 102              		.cfi_offset 4, -8
 103              		.cfi_offset 14, -4
 104              	.LVL3:
  46:Middlewares/Third_Party/ulibSD/spi_io.c ****     WORD idx;
  47:Middlewares/Third_Party/ulibSD/spi_io.c ****     for (idx=512; idx && (SPI_RW(0xFF)!=0xFF); idx--);
 105              		.loc 1 47 0
 106 0002 4FF40074 		mov	r4, #512
 107 0006 01E0     		b	.L7
 108              	.LVL4:
 109              	.L9:
 110              		.loc 1 47 0 is_stmt 0 discriminator 4
 111 0008 013C     		subs	r4, r4, #1
 112              	.LVL5:
 113 000a A4B2     		uxth	r4, r4
 114              	.LVL6:
 115              	.L7:
 116              		.loc 1 47 0 discriminator 1
 117 000c 24B1     		cbz	r4, .L6
 118              		.loc 1 47 0 discriminator 3
 119 000e FF20     		movs	r0, #255
 120 0010 FFF7FEFF 		bl	SPI_RW
 121              	.LVL7:
 122 0014 FF28     		cmp	r0, #255
 123 0016 F7D1     		bne	.L9
 124              	.L6:
 125 0018 10BD     		pop	{r4, pc}
 126              		.cfi_endproc
 127              	.LFE68:
 129              		.section	.text.SPI_CS_Low,"ax",%progbits
 130              		.align	1
ARM GAS  /tmp/cc1Sd0xR.s 			page 4


 131              		.global	SPI_CS_Low
 132              		.syntax unified
 133              		.thumb
 134              		.thumb_func
 135              		.fpu softvfp
 137              	SPI_CS_Low:
 138              	.LFB69:
  48:Middlewares/Third_Party/ulibSD/spi_io.c **** }
  49:Middlewares/Third_Party/ulibSD/spi_io.c **** 
  50:Middlewares/Third_Party/ulibSD/spi_io.c **** inline void SPI_CS_Low (void) {
 139              		.loc 1 50 0 is_stmt 1
 140              		.cfi_startproc
 141              		@ args = 0, pretend = 0, frame = 0
 142              		@ frame_needed = 0, uses_anonymous_args = 0
 143 0000 08B5     		push	{r3, lr}
 144              	.LCFI4:
 145              		.cfi_def_cfa_offset 8
 146              		.cfi_offset 3, -8
 147              		.cfi_offset 14, -4
  51:Middlewares/Third_Party/ulibSD/spi_io.c ****     HAL_GPIO_WritePin(SD_NSS_GPIO_Port, SD_NSS_Pin, GPIO_PIN_RESET);
 148              		.loc 1 51 0
 149 0002 0022     		movs	r2, #0
 150 0004 1021     		movs	r1, #16
 151 0006 0248     		ldr	r0, .L13
 152 0008 FFF7FEFF 		bl	HAL_GPIO_WritePin
 153              	.LVL8:
 154 000c 08BD     		pop	{r3, pc}
 155              	.L14:
 156 000e 00BF     		.align	2
 157              	.L13:
 158 0010 00080140 		.word	1073809408
 159              		.cfi_endproc
 160              	.LFE69:
 162              		.section	.text.SPI_CS_High,"ax",%progbits
 163              		.align	1
 164              		.global	SPI_CS_High
 165              		.syntax unified
 166              		.thumb
 167              		.thumb_func
 168              		.fpu softvfp
 170              	SPI_CS_High:
 171              	.LFB70:
  52:Middlewares/Third_Party/ulibSD/spi_io.c **** }
  53:Middlewares/Third_Party/ulibSD/spi_io.c **** 
  54:Middlewares/Third_Party/ulibSD/spi_io.c **** inline void SPI_CS_High (void){
 172              		.loc 1 54 0
 173              		.cfi_startproc
 174              		@ args = 0, pretend = 0, frame = 0
 175              		@ frame_needed = 0, uses_anonymous_args = 0
 176 0000 08B5     		push	{r3, lr}
 177              	.LCFI5:
 178              		.cfi_def_cfa_offset 8
 179              		.cfi_offset 3, -8
 180              		.cfi_offset 14, -4
  55:Middlewares/Third_Party/ulibSD/spi_io.c ****     HAL_GPIO_WritePin(SD_NSS_GPIO_Port, SD_NSS_Pin, GPIO_PIN_SET);
 181              		.loc 1 55 0
 182 0002 0122     		movs	r2, #1
ARM GAS  /tmp/cc1Sd0xR.s 			page 5


 183 0004 1021     		movs	r1, #16
 184 0006 0248     		ldr	r0, .L17
 185 0008 FFF7FEFF 		bl	HAL_GPIO_WritePin
 186              	.LVL9:
 187 000c 08BD     		pop	{r3, pc}
 188              	.L18:
 189 000e 00BF     		.align	2
 190              	.L17:
 191 0010 00080140 		.word	1073809408
 192              		.cfi_endproc
 193              	.LFE70:
 195              		.section	.text.SPI_Freq_High,"ax",%progbits
 196              		.align	1
 197              		.global	SPI_Freq_High
 198              		.syntax unified
 199              		.thumb
 200              		.thumb_func
 201              		.fpu softvfp
 203              	SPI_Freq_High:
 204              	.LFB71:
  56:Middlewares/Third_Party/ulibSD/spi_io.c **** }
  57:Middlewares/Third_Party/ulibSD/spi_io.c **** 
  58:Middlewares/Third_Party/ulibSD/spi_io.c **** inline void SPI_Freq_High (void) {
 205              		.loc 1 58 0
 206              		.cfi_startproc
 207              		@ args = 0, pretend = 0, frame = 0
 208              		@ frame_needed = 0, uses_anonymous_args = 0
 209 0000 10B5     		push	{r4, lr}
 210              	.LCFI6:
 211              		.cfi_def_cfa_offset 8
 212              		.cfi_offset 4, -8
 213              		.cfi_offset 14, -4
  59:Middlewares/Third_Party/ulibSD/spi_io.c ****     //De-initialize SPI
  60:Middlewares/Third_Party/ulibSD/spi_io.c ****     HAL_SPI_DeInit(&hspi1);
 214              		.loc 1 60 0
 215 0002 074C     		ldr	r4, .L23
 216 0004 2046     		mov	r0, r4
 217 0006 FFF7FEFF 		bl	HAL_SPI_DeInit
 218              	.LVL10:
  61:Middlewares/Third_Party/ulibSD/spi_io.c ****     //Set init struct baudrate prescaler to 2
  62:Middlewares/Third_Party/ulibSD/spi_io.c ****     hspi1.Init.BaudRatePrescaler = SPI_BAUDRATEPRESCALER_2;
 219              		.loc 1 62 0
 220 000a 0023     		movs	r3, #0
 221 000c E361     		str	r3, [r4, #28]
  63:Middlewares/Third_Party/ulibSD/spi_io.c ****     //Re-initialize SPI
  64:Middlewares/Third_Party/ulibSD/spi_io.c ****     if (HAL_SPI_Init(&hspi1) != HAL_OK)
 222              		.loc 1 64 0
 223 000e 2046     		mov	r0, r4
 224 0010 FFF7FEFF 		bl	HAL_SPI_Init
 225              	.LVL11:
 226 0014 00B9     		cbnz	r0, .L22
 227              	.L19:
 228 0016 10BD     		pop	{r4, pc}
 229              	.L22:
  65:Middlewares/Third_Party/ulibSD/spi_io.c ****     {
  66:Middlewares/Third_Party/ulibSD/spi_io.c ****         Error_Handler();
 230              		.loc 1 66 0
ARM GAS  /tmp/cc1Sd0xR.s 			page 6


 231 0018 FFF7FEFF 		bl	Error_Handler
 232              	.LVL12:
  67:Middlewares/Third_Party/ulibSD/spi_io.c ****     }
  68:Middlewares/Third_Party/ulibSD/spi_io.c **** }
 233              		.loc 1 68 0
 234 001c FBE7     		b	.L19
 235              	.L24:
 236 001e 00BF     		.align	2
 237              	.L23:
 238 0020 00000000 		.word	hspi1
 239              		.cfi_endproc
 240              	.LFE71:
 242              		.section	.text.SPI_Freq_Low,"ax",%progbits
 243              		.align	1
 244              		.global	SPI_Freq_Low
 245              		.syntax unified
 246              		.thumb
 247              		.thumb_func
 248              		.fpu softvfp
 250              	SPI_Freq_Low:
 251              	.LFB72:
  69:Middlewares/Third_Party/ulibSD/spi_io.c **** 
  70:Middlewares/Third_Party/ulibSD/spi_io.c **** inline void SPI_Freq_Low (void) {
 252              		.loc 1 70 0
 253              		.cfi_startproc
 254              		@ args = 0, pretend = 0, frame = 0
 255              		@ frame_needed = 0, uses_anonymous_args = 0
 256 0000 10B5     		push	{r4, lr}
 257              	.LCFI7:
 258              		.cfi_def_cfa_offset 8
 259              		.cfi_offset 4, -8
 260              		.cfi_offset 14, -4
  71:Middlewares/Third_Party/ulibSD/spi_io.c ****     //De-initialize SPI
  72:Middlewares/Third_Party/ulibSD/spi_io.c ****     HAL_SPI_DeInit(&hspi1);
 261              		.loc 1 72 0
 262 0002 074C     		ldr	r4, .L29
 263 0004 2046     		mov	r0, r4
 264 0006 FFF7FEFF 		bl	HAL_SPI_DeInit
 265              	.LVL13:
  73:Middlewares/Third_Party/ulibSD/spi_io.c ****     //Set init struct baudrate prescaler to 256
  74:Middlewares/Third_Party/ulibSD/spi_io.c ****     hspi1.Init.BaudRatePrescaler = SPI_BAUDRATEPRESCALER_32;
 266              		.loc 1 74 0
 267 000a 2023     		movs	r3, #32
 268 000c E361     		str	r3, [r4, #28]
  75:Middlewares/Third_Party/ulibSD/spi_io.c ****     //Re-initialize SPI
  76:Middlewares/Third_Party/ulibSD/spi_io.c ****     if (HAL_SPI_Init(&hspi1) != HAL_OK)
 269              		.loc 1 76 0
 270 000e 2046     		mov	r0, r4
 271 0010 FFF7FEFF 		bl	HAL_SPI_Init
 272              	.LVL14:
 273 0014 00B9     		cbnz	r0, .L28
 274              	.L25:
 275 0016 10BD     		pop	{r4, pc}
 276              	.L28:
  77:Middlewares/Third_Party/ulibSD/spi_io.c ****     {
  78:Middlewares/Third_Party/ulibSD/spi_io.c ****         Error_Handler();
 277              		.loc 1 78 0
ARM GAS  /tmp/cc1Sd0xR.s 			page 7


 278 0018 FFF7FEFF 		bl	Error_Handler
 279              	.LVL15:
  79:Middlewares/Third_Party/ulibSD/spi_io.c ****     }
  80:Middlewares/Third_Party/ulibSD/spi_io.c ****     
  81:Middlewares/Third_Party/ulibSD/spi_io.c ****     /*
  82:Middlewares/Third_Party/ulibSD/spi_io.c ****     if ( *RCC_CFGR & PPRE2_Mask )
  83:Middlewares/Third_Party/ulibSD/spi_io.c ****     {
  84:Middlewares/Third_Party/ulibSD/spi_io.c ****         //APB2 prescaler is >1 and APB2 timer clock is 2x APB2 clock
  85:Middlewares/Third_Party/ulibSD/spi_io.c ****         if ( ( HAL_RCC_GetPCLK2Freq() * 2 / 256 ) > 400000 )
  86:Middlewares/Third_Party/ulibSD/spi_io.c ****         {
  87:Middlewares/Third_Party/ulibSD/spi_io.c ****             Error_Handler();
  88:Middlewares/Third_Party/ulibSD/spi_io.c ****         }
  89:Middlewares/Third_Party/ulibSD/spi_io.c ****     }
  90:Middlewares/Third_Party/ulibSD/spi_io.c ****     else
  91:Middlewares/Third_Party/ulibSD/spi_io.c ****     {
  92:Middlewares/Third_Party/ulibSD/spi_io.c ****         //APB2 prescaler is x1 and APB2 timer clock = APB2 clock
  93:Middlewares/Third_Party/ulibSD/spi_io.c ****         if ( ( HAL_RCC_GetPCLK2Freq() / 256 ) > 400000 )
  94:Middlewares/Third_Party/ulibSD/spi_io.c ****         {
  95:Middlewares/Third_Party/ulibSD/spi_io.c ****             Error_Handler();
  96:Middlewares/Third_Party/ulibSD/spi_io.c ****         }
  97:Middlewares/Third_Party/ulibSD/spi_io.c ****     }
  98:Middlewares/Third_Party/ulibSD/spi_io.c ****     *SPI_CR1 |= SPI_BR_Mask;
  99:Middlewares/Third_Party/ulibSD/spi_io.c ****     */
 100:Middlewares/Third_Party/ulibSD/spi_io.c **** }
 280              		.loc 1 100 0
 281 001c FBE7     		b	.L25
 282              	.L30:
 283 001e 00BF     		.align	2
 284              	.L29:
 285 0020 00000000 		.word	hspi1
 286              		.cfi_endproc
 287              	.LFE72:
 289              		.section	.text.SPI_Timer_On,"ax",%progbits
 290              		.align	1
 291              		.global	SPI_Timer_On
 292              		.syntax unified
 293              		.thumb
 294              		.thumb_func
 295              		.fpu softvfp
 297              	SPI_Timer_On:
 298              	.LFB73:
 101:Middlewares/Third_Party/ulibSD/spi_io.c **** 
 102:Middlewares/Third_Party/ulibSD/spi_io.c **** void SPI_Timer_On (WORD ms) {
 299              		.loc 1 102 0
 300              		.cfi_startproc
 301              		@ args = 0, pretend = 0, frame = 0
 302              		@ frame_needed = 0, uses_anonymous_args = 0
 303              	.LVL16:
 304 0000 10B5     		push	{r4, lr}
 305              	.LCFI8:
 306              		.cfi_def_cfa_offset 8
 307              		.cfi_offset 4, -8
 308              		.cfi_offset 14, -4
 309 0002 0446     		mov	r4, r0
 103:Middlewares/Third_Party/ulibSD/spi_io.c ****     spiTimerTickStart = HAL_GetTick();
 310              		.loc 1 103 0
 311 0004 FFF7FEFF 		bl	HAL_GetTick
ARM GAS  /tmp/cc1Sd0xR.s 			page 8


 312              	.LVL17:
 313 0008 024B     		ldr	r3, .L33
 314 000a 1860     		str	r0, [r3]
 104:Middlewares/Third_Party/ulibSD/spi_io.c ****     spiTimerTickDelay = ms;
 315              		.loc 1 104 0
 316 000c 024B     		ldr	r3, .L33+4
 317 000e 1C60     		str	r4, [r3]
 318 0010 10BD     		pop	{r4, pc}
 319              	.L34:
 320 0012 00BF     		.align	2
 321              	.L33:
 322 0014 00000000 		.word	spiTimerTickStart
 323 0018 00000000 		.word	spiTimerTickDelay
 324              		.cfi_endproc
 325              	.LFE73:
 327              		.section	.text.SPI_Timer_Status,"ax",%progbits
 328              		.align	1
 329              		.global	SPI_Timer_Status
 330              		.syntax unified
 331              		.thumb
 332              		.thumb_func
 333              		.fpu softvfp
 335              	SPI_Timer_Status:
 336              	.LFB74:
 105:Middlewares/Third_Party/ulibSD/spi_io.c **** }
 106:Middlewares/Third_Party/ulibSD/spi_io.c **** 
 107:Middlewares/Third_Party/ulibSD/spi_io.c **** inline BOOL SPI_Timer_Status (void) {
 337              		.loc 1 107 0
 338              		.cfi_startproc
 339              		@ args = 0, pretend = 0, frame = 0
 340              		@ frame_needed = 0, uses_anonymous_args = 0
 341 0000 08B5     		push	{r3, lr}
 342              	.LCFI9:
 343              		.cfi_def_cfa_offset 8
 344              		.cfi_offset 3, -8
 345              		.cfi_offset 14, -4
 108:Middlewares/Third_Party/ulibSD/spi_io.c ****     return ((HAL_GetTick() - spiTimerTickStart) < spiTimerTickDelay);
 346              		.loc 1 108 0
 347 0002 FFF7FEFF 		bl	HAL_GetTick
 348              	.LVL18:
 349 0006 054B     		ldr	r3, .L37
 350 0008 1B68     		ldr	r3, [r3]
 351 000a C01A     		subs	r0, r0, r3
 352 000c 044B     		ldr	r3, .L37+4
 353 000e 1B68     		ldr	r3, [r3]
 109:Middlewares/Third_Party/ulibSD/spi_io.c **** }
 354              		.loc 1 109 0
 355 0010 9842     		cmp	r0, r3
 356 0012 2CBF     		ite	cs
 357 0014 0020     		movcs	r0, #0
 358 0016 0120     		movcc	r0, #1
 359 0018 08BD     		pop	{r3, pc}
 360              	.L38:
 361 001a 00BF     		.align	2
 362              	.L37:
 363 001c 00000000 		.word	spiTimerTickStart
 364 0020 00000000 		.word	spiTimerTickDelay
ARM GAS  /tmp/cc1Sd0xR.s 			page 9


 365              		.cfi_endproc
 366              	.LFE74:
 368              		.section	.text.SPI_Timer_Off,"ax",%progbits
 369              		.align	1
 370              		.global	SPI_Timer_Off
 371              		.syntax unified
 372              		.thumb
 373              		.thumb_func
 374              		.fpu softvfp
 376              	SPI_Timer_Off:
 377              	.LFB75:
 110:Middlewares/Third_Party/ulibSD/spi_io.c **** 
 111:Middlewares/Third_Party/ulibSD/spi_io.c **** inline void SPI_Timer_Off (void) {
 378              		.loc 1 111 0
 379              		.cfi_startproc
 380              		@ args = 0, pretend = 0, frame = 0
 381              		@ frame_needed = 0, uses_anonymous_args = 0
 382              		@ link register save eliminated.
 383 0000 7047     		bx	lr
 384              		.cfi_endproc
 385              	.LFE75:
 387              		.comm	spiTimerTickDelay,4,4
 388              		.comm	spiTimerTickStart,4,4
 389              		.text
 390              	.Letext0:
 391              		.file 2 "/usr/include/newlib/machine/_default_types.h"
 392              		.file 3 "/usr/include/newlib/sys/lock.h"
 393              		.file 4 "/usr/include/newlib/sys/_types.h"
 394              		.file 5 "/usr/lib/gcc/arm-none-eabi/6.3.1/include/stddef.h"
 395              		.file 6 "/usr/include/newlib/sys/reent.h"
 396              		.file 7 "/usr/include/newlib/sys/_stdint.h"
 397              		.file 8 "Middlewares/Third_Party/FatFs/src/integer.h"
 398              		.file 9 "Middlewares/Third_Party/ulibSD/integer_ulibsd.h"
 399              		.file 10 "Drivers/CMSIS/Include/core_cm3.h"
 400              		.file 11 "Drivers/CMSIS/Device/ST/STM32F1xx/Include/system_stm32f1xx.h"
 401              		.file 12 "Drivers/CMSIS/Device/ST/STM32F1xx/Include/stm32f103xb.h"
 402              		.file 13 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal_def.h"
 403              		.file 14 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal_gpio.h"
 404              		.file 15 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal_dma.h"
 405              		.file 16 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal_spi.h"
 406              		.file 17 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal.h"
 407              		.file 18 "Inc/main.h"
ARM GAS  /tmp/cc1Sd0xR.s 			page 10


DEFINED SYMBOLS
                            *ABS*:0000000000000000 spi_io.c
     /tmp/cc1Sd0xR.s:16     .text.SPI_Init:0000000000000000 $t
     /tmp/cc1Sd0xR.s:23     .text.SPI_Init:0000000000000000 SPI_Init
     /tmp/cc1Sd0xR.s:36     .text.SPI_RW:0000000000000000 $t
     /tmp/cc1Sd0xR.s:43     .text.SPI_RW:0000000000000000 SPI_RW
     /tmp/cc1Sd0xR.s:81     .text.SPI_RW:000000000000002c $d
     /tmp/cc1Sd0xR.s:86     .text.SPI_Release:0000000000000000 $t
     /tmp/cc1Sd0xR.s:93     .text.SPI_Release:0000000000000000 SPI_Release
     /tmp/cc1Sd0xR.s:130    .text.SPI_CS_Low:0000000000000000 $t
     /tmp/cc1Sd0xR.s:137    .text.SPI_CS_Low:0000000000000000 SPI_CS_Low
     /tmp/cc1Sd0xR.s:158    .text.SPI_CS_Low:0000000000000010 $d
     /tmp/cc1Sd0xR.s:163    .text.SPI_CS_High:0000000000000000 $t
     /tmp/cc1Sd0xR.s:170    .text.SPI_CS_High:0000000000000000 SPI_CS_High
     /tmp/cc1Sd0xR.s:191    .text.SPI_CS_High:0000000000000010 $d
     /tmp/cc1Sd0xR.s:196    .text.SPI_Freq_High:0000000000000000 $t
     /tmp/cc1Sd0xR.s:203    .text.SPI_Freq_High:0000000000000000 SPI_Freq_High
     /tmp/cc1Sd0xR.s:238    .text.SPI_Freq_High:0000000000000020 $d
     /tmp/cc1Sd0xR.s:243    .text.SPI_Freq_Low:0000000000000000 $t
     /tmp/cc1Sd0xR.s:250    .text.SPI_Freq_Low:0000000000000000 SPI_Freq_Low
     /tmp/cc1Sd0xR.s:285    .text.SPI_Freq_Low:0000000000000020 $d
     /tmp/cc1Sd0xR.s:290    .text.SPI_Timer_On:0000000000000000 $t
     /tmp/cc1Sd0xR.s:297    .text.SPI_Timer_On:0000000000000000 SPI_Timer_On
     /tmp/cc1Sd0xR.s:322    .text.SPI_Timer_On:0000000000000014 $d
                            *COM*:0000000000000004 spiTimerTickStart
                            *COM*:0000000000000004 spiTimerTickDelay
     /tmp/cc1Sd0xR.s:328    .text.SPI_Timer_Status:0000000000000000 $t
     /tmp/cc1Sd0xR.s:335    .text.SPI_Timer_Status:0000000000000000 SPI_Timer_Status
     /tmp/cc1Sd0xR.s:363    .text.SPI_Timer_Status:000000000000001c $d
     /tmp/cc1Sd0xR.s:369    .text.SPI_Timer_Off:0000000000000000 $t
     /tmp/cc1Sd0xR.s:376    .text.SPI_Timer_Off:0000000000000000 SPI_Timer_Off
                     .debug_frame:0000000000000010 $d

UNDEFINED SYMBOLS
HAL_SPI_TransmitReceive
hspi1
HAL_GPIO_WritePin
HAL_SPI_DeInit
HAL_SPI_Init
Error_Handler
HAL_GetTick
